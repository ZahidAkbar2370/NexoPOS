"use strict";(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[3351],{3351:(t,e,s)=>{s.r(e),s.d(e,{default:()=>o});var r=s(7389),i=s(9671),a=s(7266);const n={name:"ns-settings",props:["url"],components:{nsField:s(8737).P},data:function(){return{validation:new a.Z,form:{},test:""}},computed:{formDefined:function(){return Object.values(this.form).length>0},activeTab:function(){for(var t in this.form.tabs)if(!0===this.form.tabs[t].active)return this.form.tabs[t]}},mounted:function(){this.loadSettingsForm()},methods:{__:r.__,loadComponent:function(t){return nsExtraComponents[t]},submitForm:function(){var t=this;if(0===this.validation.validateForm(this.form).length){this.validation.disableForm(this.form);var e=this.validation.extractForm(this.form);return i.ih.post(this.url,e).subscribe({next:function(e){t.validation.enableForm(t.form),t.loadSettingsForm(),e.data&&e.data.results&&e.data.results.forEach((function(t){"failed"===t.status?i.kX.error(t.message).subscribe():i.kX.success(t.message).subscribe()})),i.kq.doAction("ns-settings-saved",{result:e,instance:t}),i.kX.success(e.message).subscribe()},error:function(e){t.validation.enableForm(t.form),t.validation.triggerFieldsErrors(t.form,e),i.kq.doAction("ns-settings-failed",{error:e,instance:t}),i.kX.error(e.message||(0,r.__)("Unable to proceed the form is not valid.")).subscribe()}})}i.kX.error(this.$slots["error-form-invalid"][0].text||(0,r.__)("Unable to proceed the form is not valid.")).subscribe()},setActive:function(t){for(var e in this.form.tabs)this.form.tabs[e].active=!1;t.active=!0,i.kq.doAction("ns-settings-change-tab",{tab:t,instance:this})},loadSettingsForm:function(){var t=this;i.ih.get(this.url).subscribe((function(e){var s=0;Object.values(e.tabs).filter((function(t){return t.active})).length;for(var r in e.tabs)t.formDefined?e.tabs[r].active=t.form.tabs[r].active:(e.tabs[r].active=!1,0===s&&(e.tabs[r].active=!0)),s++;t.form=t.validation.createForm(e),i.kq.doAction("ns-settings-loaded",t),i.kq.doAction("ns-settings-change-tab",{tab:t.activeTab,instance:t})}))}}};const o=(0,s(1900).Z)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.formDefined?s("div",{attrs:{id:"tabbed-card"}},[s("div",{staticClass:"flex flex-wrap",attrs:{id:"card-header"}},t._l(t.form.tabs,(function(e,r){return s("div",{key:r,staticClass:"text-gray-700 dark:text-white cursor-pointer flex items-center px-4 py-2 rounded-tl-lg rounded-tr-lg",class:e.active?"bg-white dark:bg-slate-700 dark:text-white":"bg-gray-300 dark:bg-slate-800 dark:text-slate-200",on:{click:function(s){return t.setActive(e)}}},[s("span",[t._v(t._s(e.label))]),t._v(" "),e.errors&&e.errors.length>0?s("span",{staticClass:"ml-2 rounded-full bg-red-400 text-white text-sm h-6 w-6 flex items-center justify-center"},[t._v(t._s(e.errors.length))]):t._e()])})),0),t._v(" "),s("div",{staticClass:"card-body bg-white dark:bg-slate-700 dark:text-white rounded-br-lg rounded-bl-lg shadow"},[s("div",{staticClass:"-mx-4 flex flex-wrap p-2"},[t.activeTab.fields?t._l(t.activeTab.fields,(function(t,e){return s("div",{key:e,staticClass:"w-full px-4 md:w-1/2 lg:w-1/3"},[s("div",{staticClass:"flex flex-col my-2"},[s("ns-field",{attrs:{field:t}})],1)])})):t._e(),t._v(" "),t.activeTab.component?s("div",{staticClass:"w-full px-4"},[s(t.loadComponent(t.activeTab.component),{tag:"component"})],1):t._e()],2),t._v(" "),t.activeTab.fields?s("div",{staticClass:"border-t border-gray-400 dark:border-slate-600 p-2 flex justify-end"},[s("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitForm()}}},[t._t("submit-button",(function(){return[t._v(t._s(t.__("Save Settings")))]}))],2)],1):t._e()])]):t._e()}),[],!1,null,null,null).exports}}]);