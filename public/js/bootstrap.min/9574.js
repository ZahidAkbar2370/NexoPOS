"use strict";(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[9574,2004],{9763:(e,t,r)=>{function s(e){POS.changeVisibleSection(e)}r.d(t,{Z:()=>s})},279:(e,t,r)=>{r.d(t,{$:()=>c});var s=r(9671),n=r(7389),o=r(2242),i=r(2245);function a(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,r,c;return t=e,(r=[{key:"run",value:function(e){var t=this;return new Promise((function(r,a){var c=new o.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),l=t.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===l.$original().stock_management){var u=POS.getStockUsage(l.$original().id,e.unit_quantity_id)-(l.quantity||0);if(1>parseFloat(e.$quantities().quantity)-u)return s.kX.error((0,n.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(e.$quantities().quantity-u).toString())).subscribe()}r({quantity:1})}else c.open(i.default,{resolve:r,reject:a,product:l,data:e})}))}}])&&a(t.prototype,r),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9574:(e,t,r)=>{r.r(t),r.d(t,{default:()=>X});var s=r(7757),n=r.n(s),o=r(2242),i=r(279),a=r(9671),c=r(7389);function l(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,r,s;return t=e,(r=[{key:"run",value:function(){var e=this;return new Promise((function(t,r){return 0===e.order.products.length?(a.kX.error((0,c.__)("You need to provide some products before proceeding.")).subscribe(),r(!1)):t(!0)}))}}])&&l(t.prototype,r),s&&l(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.ProductsQueue=u;var d=r(5986);function p(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,r,s;return t=e,(r=[{key:"run",value:function(){var e=this;return new Promise((function(t,r){return void 0===e.order.customer?o.G.show(d.default,{resolve:t,reject:r}):t(!0)}))}}])&&p(t.prototype,r),s&&p(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.CustomerQueue=_;var f=r(4916);function b(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,r,s;return t=e,(r=[{key:"run",value:function(){var e=this;return new Promise((function(t,r){o.G.show(f.default,{resolve:t,reject:r,order:e.order})}))}}])&&b(t.prototype,r),s&&b(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();function h(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}window.PaymentQueue=v;var m=r(2600).default,y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,r,s;return t=e,(r=[{key:"run",value:function(){var e=this;return new Promise((function(t,r){if(void 0===e.order.type)return o.G.show(m,{resolve:t,reject:r});t(!0)}))}}])&&h(t.prototype,r),s&&h(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.TypeQueue=y;var g=r(9763);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t,r,s,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(s,n)}function P(e){return function(){var t=this,r=arguments;return new Promise((function(s,n){var o=e.apply(t,r);function i(e){k(o,s,n,i,a,"next",e)}function a(e){k(o,s,n,i,a,"throw",e)}i(void 0)}))}}var S=function(){return Promise.resolve().then(r.bind(r,5986))},O=function(){return Promise.resolve().then(r.bind(r,1096))},j=function(){return Promise.resolve().then(r.bind(r,3768))},T=function(){return Promise.resolve().then(r.bind(r,2600))},V=function(){return r.e(7585).then(r.bind(r,7585))},$=function(){return r.e(7391).then(r.bind(r,7391))},A=function(){return Promise.resolve().then(r.bind(r,2004))},F=function(){return r.e(8104).then(r.bind(r,8104))},E=function(){return r.e(4237).then(r.bind(r,4237))},q=function(){return Promise.resolve().then(r.bind(r,4555))},G=function(){return r.e(6110).then(r.bind(r,6110))},L=function(){return r.e(2796).then(r.bind(r,2796))},N=function(){return r.e(2431).then(r.bind(r,2431))};const D={name:"ns-pos-cart",data:function(){return{popup:null,products:[],visibleSection:null,visibleSectionSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:{}}},computed:{selectedType:function(){return this.order.type?this.order.type.label:"N/A"},isVisible:function(){return"cart"===this.visibleSection},customerName:function(){return this.order.customer?this.order.customer.name:"N/A"},couponName:function(){return"Apply Coupon"}},mounted:function(){var e=this;this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),this.typeSubscribe=POS.types.subscribe((function(t){return e.types=t})),this.orderSubscribe=POS.order.subscribe((function(t){e.order=t})),this.productSubscribe=POS.products.subscribe((function(t){e.products=t,e.$forceUpdate()})),this.settingsSubscribe=POS.settings.subscribe((function(t){e.settings=t})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:c.__,switchTo:g.Z,openAddQuickProduct:function(){new Promise((function(e,t){o.G.show(N,{resolve:e,reject:t})})).then((function(e){})).catch((function(e){}))},changeProductPrice:function(e){var t=this;return P(n().mark((function r(){var s,i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.settings.edit_purchase_price){r.next=2;break}return r.abrupt("return",a.kX.error((0,c.__)("You don't have the right to edit the purchase price.")).subscribe());case 2:if(!t.settings.unit_price_editable){r.next=19;break}return r.prev=3,r.next=6,new Promise((function(t,r){return o.G.show(L,{product:Object.assign({},e),resolve:t,reject:r})}));case 6:return s=r.sent,i=C(C({},e.$quantities()),{custom_price_edit:s}),e.$quantities=function(){return i},e.mode="custom",e=POS.computeProductTax(e),POS.refreshProducts(POS.products.getValue()),POS.refreshCart(),r.abrupt("return",a.kX.success((0,c.__)("The product price has been updated.")).subscribe());case 16:return r.prev=16,r.t0=r.catch(3),r.abrupt("return");case 19:return r.abrupt("return",a.kX.error((0,c.__)("The editable price feature is disabled.")).subscribe());case 20:case"end":return r.stop()}}),r,null,[[3,16]])})))()},selectCoupon:function(){return P(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){o.G.show(q,{resolve:e,reject:t})}));case 3:e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()},defineOrderSettings:function(){var e=this;return P(n().mark((function t(){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.settings.edit_settings){t.next=2;break}return t.abrupt("return",a.kX.error((0,c.__)("You're not allowed to edit the order settings.")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,r){o.G.show(G,{resolve:t,reject:r,order:e.order})}));case 5:r=t.sent,POS.order.next(C(C({},e.order),r)),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})))()},openNotePopup:function(){var e=this;return P(n().mark((function t(){var r,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){var s=e.order.note,n=e.order.note_visibility;o.G.show(F,{resolve:t,reject:r,note:s,note_visibility:n})}));case 3:r=t.sent,s=C(C({},e.order),r),POS.order.next(s),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),!1!==t.t0&&a.kX.error(t.t0.message).subscribe();case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},selectTaxGroup:function(){var e=arguments,t=this;return P(n().mark((function r(){var s,i,a;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.length>0&&void 0!==e[0]?e[0]:"settings",r.prev=1,r.next=4,new Promise((function(e,r){var n=t.order.taxes,i=t.order.tax_group_id,a=t.order.tax_type;o.G.show(E,{resolve:e,reject:r,taxes:n,tax_group_id:i,tax_type:a,activeTab:s})}));case 4:i=r.sent,a=C(C({},t.order),i),POS.order.next(a),POS.refreshCart(),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(1),console.log(r.t0);case 13:case"end":return r.stop()}}),r,null,[[1,10]])})))()},openTaxSummary:function(){this.selectTaxGroup("summary")},voidOngoingOrder:function(){POS.voidOrder(this.order)},holdOrder:function(){var e=this;return P(n().mark((function t(){var r,s,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("hold"!==e.order.payment_status&&e.order.payments.length>0)){t.next=2;break}return t.abrupt("return",a.kX.error("Unable to hold an order which payment status has been updated already.").subscribe());case 2:r=a.kq.applyFilters("ns-hold-queue",[u,_,y]),t.t0=n().keys(r);case 4:if((t.t1=t.t0()).done){t.next=18;break}return s=t.t1.value,t.prev=6,i=new r[s](e.order),t.next=10,i.run();case 10:t.sent,t.next=16;break;case 13:return t.prev=13,t.t2=t.catch(6),t.abrupt("return",!1);case 16:t.next=4;break;case 18:a.kq.applyFilters("ns-override-hold-popup",(function(){new Promise((function(t,r){o.G.show($,{resolve:t,reject:r,order:e.order})})).then((function(t){e.order.title=t.title,e.order.payment_status="hold",POS.order.next(e.order);var r=o.G.show(A);POS.submitOrder().then((function(e){r.close(),a.kX.success(e.message).subscribe()}),(function(e){r.close(),a.kX.error(e.message).subscribe()}))}))}))();case 20:case"end":return t.stop()}}),t,null,[[6,13]])})))()},openDiscountPopup:function(e,t){return this.settings.products_discount||"product"!==t?this.settings.cart_discount||"cart"!==t?void o.G.show(j,{reference:e,type:t,onSubmit:function(r){"product"===t?POS.updateProduct(e,r):"cart"===t&&POS.updateCart(e,r)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"}):a.kX.error("You're not allowed to add a discount on the cart.").subscribe():a.kX.error("You're not allowed to add a discount on the product.").subscribe()},selectCustomer:function(){o.G.show(S)},toggleMode:function(e){"normal"===e.mode?o.G.show(O,{title:"Enable WholeSale Price",message:"Would you like to switch to wholesale price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"wholesale"})}}):o.G.show(O,{title:"Enable Normal Price",message:"Would you like to switch to normal price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"normal"})}})},remove:function(e){o.G.show(O,{title:"Confirm Your Action",message:"Would you like to delete this product ?",onAction:function(t){t&&POS.removeProduct(e)}})},changeQuantity:function(e){new i.$(e).run({unit_quantity_id:e.unit_quantity_id,unit_name:e.unit_name,$quantities:e.$quantities}).then((function(t){POS.updateProduct(e,t)}))},payOrder:function(){var e=this;return P(n().mark((function t(){var r,s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.kq.applyFilters("ns-pay-queue",[u,_,y,v]),t.t0=n().keys(r);case 2:if((t.t1=t.t0()).done){t.next=16;break}return s=t.t1.value,t.prev=4,o=new r[s](e.order),t.next=8,o.run();case 8:t.sent,t.next=14;break;case 11:return t.prev=11,t.t2=t.catch(4),t.abrupt("return",!1);case 14:t.next=2;break;case 16:case"end":return t.stop()}}),t,null,[[4,11]])})))()},openOrderType:function(){o.G.show(T)},openShippingPopup:function(){o.G.show(V)}}};const X=(0,r(1900).Z)(D,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-cart"}},["cart"===e.visibleSection?r("div",{staticClass:"flex pl-2",attrs:{id:"tools"}},[r("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-white font-semibold text-gray-700",on:{click:function(t){return e.switchTo("cart")}}},[r("span",[e._v(e._s(e.__("Cart")))]),e._v(" "),e.order?r("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[e._v(e._s(e.order.products.length))]):e._e()]),e._v(" "),r("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-gray-300 border-t border-r border-l border-gray-300 text-gray-600",on:{click:function(t){return e.switchTo("grid")}}},[e._v("\n            "+e._s(e.__("Products"))+"\n        ")])]):e._e(),e._v(" "),r("div",{staticClass:"rounded shadow bg-white flex-auto flex overflow-hidden"},[r("div",{staticClass:"cart-table flex flex-auto flex-col overflow-hidden"},[r("div",{staticClass:"w-full p-2 border-b border-gray-300",attrs:{id:"cart-toolbox"}},[r("div",{staticClass:"border border-gray-300 rounded overflow-hidden"},[r("div",{staticClass:"flex flex-wrap"},[r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none",on:{click:function(t){return e.openNotePopup()}}},[r("i",{staticClass:"las la-comment"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Comments")))])])]),e._v(" "),r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.selectTaxGroup()}}},[r("i",{staticClass:"las la-balance-scale-left"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Taxes")))]),e._v(" "),e.order.taxes&&e.order.taxes.length>0?r("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-blue-400 text-white"},[e._v(e._s(e.order.taxes.length))]):e._e()])]),e._v(" "),r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.selectCoupon()}}},[r("i",{staticClass:"las la-tags"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Coupons")))]),e._v(" "),e.order.coupons&&e.order.coupons.length>0?r("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-blue-400 text-white"},[e._v(e._s(e.order.coupons.length))]):e._e()])]),e._v(" "),r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.defineOrderSettings()}}},[r("i",{staticClass:"las la-tools"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Settings")))])])]),e._v(" "),"yes"===e.options.ns_pos_quick_product?r("div",[r("button",{staticClass:"w-full h-10 px-3 bg-gray-200 border-r border-gray-300 outline-none flex items-center",on:{click:function(t){return e.openAddQuickProduct()}}},[r("i",{staticClass:"las la-plus"}),e._v(" "),r("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Product")))])])]):e._e()])])]),e._v(" "),r("div",{staticClass:"w-full text-gray-700 font-semibold flex",attrs:{id:"cart-table-header"}},[r("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-gray-200 bg-gray-100"},[e._v(e._s(e.__("Product")))]),e._v(" "),r("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0 border-gray-200 bg-gray-100"},[e._v(e._s(e.__("Quantity")))]),e._v(" "),r("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0 border-gray-200 bg-gray-100"},[e._v(e._s(e.__("Total")))])]),e._v(" "),r("div",{staticClass:"flex flex-auto flex-col overflow-auto",attrs:{id:"cart-products-table"}},[0===e.products.length?r("div",{staticClass:"text-gray-700 flex"},[r("div",{staticClass:"w-full text-center py-4 border-b border-gray-200"},[r("h3",{staticClass:"text-gray-600"},[e._v(e._s(e.__("No products added...")))])])]):e._e(),e._v(" "),e._l(e.products,(function(t,s){return r("div",{key:t.barcode,staticClass:"text-gray-700 flex",attrs:{"product-index":s}},[r("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-gray-200"},[r("div",{staticClass:"flex justify-between product-details mb-1"},[r("h3",{staticClass:"font-semibold"},[e._v("\n                                "+e._s(t.name)+" — "+e._s(t.unit_name)+"\n                            ")]),e._v(" "),r("div",{staticClass:"-mx-1 flex product-options"},[r("div",{staticClass:"px-1"},[r("a",{staticClass:"hover:text-red-400 cursor-pointer outline-none border-dashed py-1 border-b border-red-400 text-sm",on:{click:function(r){return e.remove(t)}}},[r("i",{staticClass:"las la-trash text-xl"})])]),e._v(" "),r("div",{staticClass:"px-1"},[r("a",{staticClass:"hover:text-blue-600 cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-green-600 border-green-600":"border-blue-400",on:{click:function(r){return e.toggleMode(t)}}},[r("i",{staticClass:"las la-award text-xl"})])])])]),e._v(" "),r("div",{staticClass:"flex justify-between product-controls"},[r("div",{staticClass:"-mx-1 flex flex-wrap"},[r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[r("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-green-600 hover:text-green-700 border-green-600":"hover:text-blue-400 border-blue-400",on:{click:function(r){return e.changeProductPrice(t)}}},[e._v(e._s(e.__("Price"))+" : "+e._s(e._f("currency")(t.unit_price)))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(r){return e.openDiscountPopup(t,"product")}}},[e._v(e._s(e.__("Discount"))+" "),"percentage"===t.discount_type?r("span",[e._v(e._s(t.discount_percentage)+"%")]):e._e(),e._v(" : "+e._s(e._f("currency")(t.discount)))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(r){return e.changeQuantity(t)}}},[e._v(e._s(e.__("Quantity :"))+" "+e._s(t.quantity))])]),e._v(" "),r("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[r("span",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm"},[e._v(e._s(e.__("Total :"))+" "+e._s(e._f("currency")(t.total_price)))])])])])]),e._v(" "),r("div",{staticClass:"hidden lg:flex w-1/6 p-2 border-b border-gray-200 items-center justify-center cursor-pointer hover:bg-blue-100",on:{click:function(r){return e.changeQuantity(t)}}},[r("span",{staticClass:"border-b border-dashed border-blue-400 p-2"},[e._v(e._s(t.quantity))])]),e._v(" "),r("div",{staticClass:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 border-gray-200 items-center justify-center"},[e._v(e._s(e._f("currency")(t.total_price)))])])}))],2),e._v(" "),r("div",{staticClass:"flex",attrs:{id:"cart-products-summary"}},["both"===e.visibleSection?r("table",{staticClass:"table w-full text-sm text-gray-700"},[r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v("Customer : "+e._s(e.customerName))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e._v(e._s(e.__("Sub Total")))]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.subtotal)))])]),e._v(" "),r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v(e._s(e.__("Type :"))+" "+e._s(e.selectedType))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("span",[e._v(e._s(e.__("Discount")))]),e._v(" "),"percentage"===e.order.discount_type?r("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?r("span",[e._v("("+e._s(e.__("Flat"))+")")]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}}),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v(e._s(e.__("Shipping")))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.shipping)))])]):e._e(),e._v(" "),r("tr",{staticClass:"bg-green-200"},[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e.order?r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v("Tax : "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e._v(e._s(e.__("Total")))]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.total)))])])]):e._e(),e._v(" "),"cart"===e.visibleSection?r("table",{staticClass:"table w-full text-sm text-gray-700"},[r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v(e._s(e.__("Customer :"))+" "+e._s(e.customerName))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between"},[r("span",[e._v(e._s(e.__("Sub Total")))]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.subtotal)))])])])]),e._v(" "),r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v(e._s(e.__("Type :"))+" "+e._s(e.selectedType))])]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between items-center"},[r("p",[r("span",[e._v(e._s(e.__("Discount")))]),e._v(" "),"percentage"===e.order.discount_type?r("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?r("span",[e._v("("+e._s(e.__("Flat"))+")")]):e._e()]),e._v(" "),r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?r("tr",[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}}),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v(e._s(e.__("Shipping")))]),e._v(" "),r("span")])]):e._e(),e._v(" "),r("tr",{staticClass:"bg-green-200"},[r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e.order?r("a",{staticClass:"hover:text-blue-400 cursor-pointer outline-none border-dashed py-1 border-b border-blue-400 text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v(e._s(e.__("Tax :"))+" "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[r("div",{staticClass:"flex justify-between w-full"},[r("span",[e._v(e._s(e.__("Total")))]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])])])])]):e._e()]),e._v(" "),r("div",{staticClass:"h-16 flex flex-shrink-0 border-t border-gray-200",attrs:{id:"cart-bottom-buttons"}},[r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto",attrs:{id:"pay-button"},on:{click:function(t){return e.payOrder()}}},[r("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-cash-register"}),e._v(" "),r("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Pay")))])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto",attrs:{id:"hold-button"},on:{click:function(t){return e.holdOrder()}}},[r("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-pause"}),e._v(" "),r("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Hold")))])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-white border-r border-gray-200 hover:bg-indigo-100 flex-auto text-gray-700",attrs:{id:"discount-button"},on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[r("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-percent"}),e._v(" "),r("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Discount")))])]),e._v(" "),r("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-gray-200 hover:bg-red-600 flex-auto",attrs:{id:"void-button"},on:{click:function(t){return e.voidOngoingOrder(e.order)}}},[r("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-trash"}),e._v(" "),r("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Void")))])])])])])])}),[],!1,null,null,null).exports},4555:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var s=r(8603),n=r(6386),o=r(9671),i=r(7389),a=r(5986);r(9624);const c={name:"ns-pos-coupons-load-popup",data:function(){return{placeHolder:(0,i.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var e=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t,e.order.coupons.length>0&&(e.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(t){e.customerCoupon=t,e.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:i.__,popupCloser:s.Z,popupResolver:n.Z,selectCustomer:function(){Popup.show(a.default)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(e){this.order.coupons.splice(e,1),POS.refreshCart()},apply:function(){var e=this;try{var t=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return o.kX.error((0,i.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return o.kX.error((0,i.__)("The coupon is out from validity date range.")).subscribe();var r=this.customerCoupon.coupon.products;if(r.length>0){var s=r.map((function(e){return e.product_id}));if(0===this.order.products.filter((function(e){return s.includes(e.product_id)})).length)return o.kX.error((0,i.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var n=this.customerCoupon.coupon.categories;if(n.length>0){var a=n.map((function(e){return e.category_id}));if(0===this.order.products.filter((function(e){return a.includes(e.$original().category_id)})).length)return o.kX.error((0,i.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var c={active:t.coupon.active,customer_coupon_id:t.id,minimum_cart_value:t.coupon.minimum_cart_value,maximum_cart_value:t.coupon.maximum_cart_value,name:t.coupon.name,type:t.coupon.type,value:0,limit_usage:t.coupon.limit_usage,code:t.coupon.code,discount_value:t.coupon.discount_value,categories:t.coupon.categories,products:t.coupon.products};POS.pushCoupon(c),this.activeTab="active-coupons",setTimeout((function(){e.popupResolver(c)}),500),o.kX.success((0,i.__)("The coupon has applied to the cart.")).subscribe()}catch(e){console.log(e)}},getCouponType:function(e){switch(e){case"percentage_discount":return(0,i.__)("Percentage");case"flat_discount":return(0,i.__)("Flat");default:return(0,i.__)("Unknown Type")}},getDiscountValue:function(e){switch(e.type){case"percentage_discount":return e.discount_value+"%";case"flat_discount":return this.$options.filters.currency(e.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(e){this.activeTab=e},getCoupon:function(e){return!this.order.customer_id>0?o.kX.error((0,i.__)("You must select a customer before applying a coupon.")).subscribe():o.ih.post("/api/nexopos/v4/customers/coupons/".concat(e),{customer_id:this.order.customer_id})},loadCoupon:function(){var e=this,t=this.couponCode;this.getCoupon(t).subscribe({next:function(t){e.customerCoupon=t,o.kX.success((0,i.__)("The coupon has been loaded.")).subscribe()},error:function(e){o.kX.error(e.message||(0,i.__)("An unexpected error occured.")).subscribe()}})}}};const l=(0,r(1900).Z)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shadow-lg bg-white w-95vw md:w-3/6-screen lg:w-2/6-screen"},[r("div",{staticClass:"border-b border-gray-200 p-2 flex justify-between items-center"},[r("h3",{staticClass:"font-bold text-gray-700"},[e._v(e._s(e.__("Load Coupon")))]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),r("div",{staticClass:"p-1"},[r("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.setActiveTab(t)}}},[r("ns-tabs-item",{attrs:{label:e.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[r("div",{staticClass:"border-2 border-blue-400 rounded flex"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full p-2",attrs:{type:"text",placeholder:e.placeHolder},domProps:{value:e.couponCode},on:{input:function(t){t.target.composing||(e.couponCode=t.target.value)}}}),e._v(" "),r("button",{staticClass:"bg-blue-400 text-white px-3 py-2",on:{click:function(t){return e.loadCoupon()}}},[e._v(e._s(e.__("Load")))])]),e._v(" "),r("div",{staticClass:"pt-2"},[r("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[e._v(e._s(e.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))])]),e._v(" "),e.order&&void 0===e.order.customer_id?r("div",{staticClass:"pt-2",on:{click:function(t){return e.selectCustomer()}}},[r("p",{staticClass:"p-2 cursor-pointer text-center bg-red-100 text-red-600"},[e._v(e._s(e.__("Click here to choose a customer.")))])]):e._e(),e._v(" "),e.order&&void 0!==e.order.customer_id?r("div",{staticClass:"pt-2"},[r("p",{staticClass:"p-2 text-center bg-green-100 text-green-600"},[e._v(e._s(e.__("Loading Coupon For : ")+e.order.customer.name+" "+e.order.customer.surname))])]):e._e(),e._v(" "),r("div",{staticClass:"overflow-hidden"},[e.customerCoupon?r("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto h-64"},[r("table",{staticClass:"w-full"},[r("thead",[r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Coupon Name")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.name))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Discount"))+" ("+e._s(e.getCouponType(e.customerCoupon.coupon.type))+")")]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.getDiscountValue(e.customerCoupon.coupon)))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Usage")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.usage+"/"+(e.customerCoupon.limit_usage||e.__("Unlimited"))))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Valid From")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_start))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Valid Till")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_end))])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Categories")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[r("ul",e._l(e.customerCoupon.coupon.categories,(function(t){return r("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[e._v(e._s(t.category.name))])})),0)])]),e._v(" "),r("tr",[r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[e._v(e._s(e.__("Products")))]),e._v(" "),r("td",{staticClass:"p-2 w-1/2 text-gray-700 border border-gray-200"},[r("ul",e._l(e.customerCoupon.coupon.products,(function(t){return r("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border border-gray-200"},[e._v(e._s(t.product.name))])})),0)])])])])]):e._e()])]),e._v(" "),r("ns-tabs-item",{attrs:{label:e.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[e.order?r("ul",[e._l(e.order.coupons,(function(t,s){return r("li",{key:s,staticClass:"flex justify-between bg-gray-100 items-center px-2 py-1"},[r("div",{staticClass:"flex-auto"},[r("h3",{staticClass:"font-semibold text-gray-700 p-2 flex justify-between"},[r("span",[e._v(e._s(t.name))]),e._v(" "),r("span",[e._v(e._s(e.getDiscountValue(t)))])])]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.removeCoupon(s)}}})],1)])})),e._v(" "),0===e.order.coupons.length?r("li",{staticClass:"flex justify-between bg-gray-100 items-center p-2"},[e._v("\n                        No coupons applies to the cart.\n                    ")]):e._e()],2):e._e()])],1)],1),e._v(" "),e.customerCoupon?r("div",{staticClass:"flex"},[r("button",{staticClass:"w-1/2 px-3 py-2 bg-green-400 text-white font-bold",on:{click:function(t){return e.apply()}}},[e._v("\n            "+e._s(e.__("Apply"))+"\n        ")]),e._v(" "),r("button",{staticClass:"w-1/2 px-3 py-2 bg-red-400 text-white font-bold",on:{click:function(t){return e.cancel()}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n        ")])]):e._e()])}),[],!1,null,null,null).exports},5986:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var s=r(9671),n=r(6386),o=r(2242),i=r(6851);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(e){var t=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){t.searchCustomer(e)}),500)}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(t){e.order=t})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:r(7389).__,resolveIfQueued:n.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);s.kX.info("Too many result.").subscribe()},openCustomerHistory:function(e,t){t.stopImmediatePropagation(),this.$popup.close(),o.G.show(i.Z,{customer:e,activeTab:"account-payment"})},selectCustomer:function(e){var t=this;this.customers.forEach((function(e){return e.selected=!1})),e.selected=!0,this.isLoading=!0,POS.selectCustomer(e).then((function(r){t.isLoading=!1,t.resolveIfQueued(e)})).catch((function(e){t.isLoading=!1}))},searchCustomer:function(e){var t=this;s.ih.post("/api/nexopos/v4/customers/search",{search:e}).subscribe((function(e){e.forEach((function(e){return e.selected=!1})),t.customers=e}))},createCustomerWithMatch:function(e){this.resolveIfQueued(!1),o.G.show(i.Z,{name:e})},getRecentCustomers:function(){var e=this;this.isLoading=!0,s.ih.get("/api/nexopos/v4/customers").subscribe((function(t){e.isLoading=!1,t.forEach((function(e){return e.selected=!1})),e.customers=t}),(function(t){e.isLoading=!1}))}}};const c=(0,r(1900).Z)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108"},[r("div",{staticClass:"border-b border-gray-200 text-center font-semibold text-2xl text-gray-700 py-2",attrs:{id:"header"}},[r("h2",[e._v(e._s(e.__("Select Customer")))])]),e._v(" "),r("div",{staticClass:"relative"},[r("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between text-gray-600"},[r("span",[e._v("Selected : ")]),e._v(" "),r("div",{staticClass:"flex items-center justify-between"},[r("span",[e._v(e._s(e.order.customer?e.order.customer.name:"N/A"))]),e._v(" "),e.order.customer?r("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border border-gray-200 hover:bg-blue-400 hover:text-white hover:border-transparent",on:{click:function(t){return e.openCustomerHistory(e.order.customer,t)}}},[r("i",{staticClass:"las la-eye"})]):e._e()])]),e._v(" "),r("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between text-gray-600"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"rounded border-2 border-blue-400 bg-gray-100 w-full p-2",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:e.searchCustomerValue},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.attemptToChoose()},input:function(t){t.target.composing||(e.searchCustomerValue=t.target.value)}}})]),e._v(" "),r("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto"},[r("ul",[e.customers&&0===e.customers.length?r("li",{staticClass:"p-2 text-center text-gray-600"},[e._v("\n                    "+e._s(e.__("No customer match your query..."))+"\n                ")]):e._e(),e._v(" "),e.customers&&0===e.customers.length?r("li",{staticClass:"p-2 cursor-pointer text-center text-gray-600",on:{click:function(t){return e.createCustomerWithMatch(e.searchCustomerValue)}}},[r("span",{staticClass:"border-b border-dashed border-blue-400"},[e._v(e._s(e.__("Create a customer")))])]):e._e(),e._v(" "),e._l(e.customers,(function(t){return r("li",{key:t.id,staticClass:"cursor-pointer hover:bg-gray-100 p-2 border-b border-gray-200 text-gray-600 flex justify-between items-center",on:{click:function(r){return e.selectCustomer(t)}}},[r("span",[e._v(e._s(t.name))]),e._v(" "),r("p",{staticClass:"flex items-center"},[t.owe_amount>0?r("span",{staticClass:"text-red-600"},[e._v("-"+e._s(e._f("currency")(t.owe_amount)))]):e._e(),e._v(" "),t.owe_amount>0?r("span",[e._v("/")]):e._e(),e._v(" "),r("span",{staticClass:"text-green-600"},[e._v(e._s(e._f("currency")(t.purchases_amount)))]),e._v(" "),r("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border border-gray-200 hover:bg-blue-400 hover:text-white hover:border-transparent",on:{click:function(r){return e.openCustomerHistory(t,r)}}},[r("i",{staticClass:"las la-eye"})])])])}))],2)]),e._v(" "),e.isLoading?r("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[r("ns-spinner",{attrs:{size:"24",border:"8"}})],1):e._e()])])}),[],!1,null,null,null).exports},6851:(e,t,r)=>{r.d(t,{Z:()=>v});var s=r(8603),n=r(9671),o=r(2242),i=r(5986),a=r(7266),c=r(7389);const l={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new a.Z}},methods:{__:c.__,closeWithOverlayClicked:s.Z,proceed:function(){var e=this,t=this.$popupParams.customer,r=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,n.ih.post("/api/nexopos/v4/customers/".concat(t.id,"/account-history"),r).subscribe((function(t){e.isSubmiting=!1,n.kX.success(t.message).subscribe(),e.$popupParams.resolve(t),e.$popup.close()}),(function(t){e.isSubmiting=!1,n.kX.error(t.message).subscribe(),e.$popupParams.reject(t)}))},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var e=this;n.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe((function(t){e.fields=e.formValidation.createFields(t)}))}}};var u=r(1900);const d=(0,u.Z)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg bg-white flex flex-col relative"},[r("div",{staticClass:"p-2 border-b border-gray-200 flex justify-between items-center"},[r("h2",{staticClass:"font-semibold"},[e._v(e._s(e.__("New Transaction")))]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),r("div",{staticClass:"flex-auto overflow-y-auto"},[0===e.fields.length?r("div",{staticClass:"h-full w-full flex items-center justify-center"},[r("ns-spinner")],1):e._e(),e._v(" "),e.fields.length>0?r("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return r("ns-field",{key:t,attrs:{field:e}})})),1):e._e()]),e._v(" "),r("div",{staticClass:"p-2 bg-white justify-between border-t border-gray-200 flex"},[r("div"),e._v(" "),r("div",{staticClass:"px-1"},[r("div",{staticClass:"-mx-2 flex flex-wrap"},[r("div",{staticClass:"px-1"},[r("ns-button",{attrs:{type:"danger"},on:{click:function(t){return e.close()}}},[e._v(e._s(e.__("Close")))])],1),e._v(" "),r("div",{staticClass:"px-1"},[r("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.proceed()}}},[e._v(e._s(e.__("Proceed")))])],1)])])]),e._v(" "),0===e.isSubmiting?r("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[r("ns-spinner")],1):e._e()])}),[],!1,null,null,null).exports;var p=r(4555),_=r(1096),f=r(6386);const b={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,coupons:[],rewardsResponse:[],order:null}},components:{nsPaginate:r(5834).Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var e=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),this.subscription=POS.order.subscribe((function(t){e.order=t,void 0!==e.$popupParams.customer?(e.activeTab="account-payment",e.customer=e.$popupParams.customer,e.loadCustomerOrders(e.customer.id)):void 0!==t.customer&&(e.activeTab="account-payment",e.customer=t.customer,e.loadCustomerOrders(e.customer.id))})),this.popupCloser()},methods:{__:c.__,popupResolver:f.Z,popupCloser:s.Z,getType:function(e){switch(e){case"percentage_discount":return(0,c.__)("Percentage Discount");case"flat_discount":return(0,c.__)("Flat Discount")}},closeWithOverlayClicked:s.Z,doChangeTab:function(e){this.selectedTab=e,"coupons"===e&&this.loadCoupons(),"rewards"===e&&this.loadRewards()},loadCoupons:function(){var e=this;this.isLoadingCoupons=!0,n.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(t){e.coupons=t,e.isLoadingCoupons=!1},error:function(t){e.isLoadingCoupons=!1}})},loadRewards:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,n.ih.get(t).subscribe({next:function(t){e.rewardsResponse=t,e.isLoadingRewards=!1},error:function(t){e.isLoadingRewards=!1}})},allowedForPayment:function(e){return["unpaid","partially_paid","hold"].includes(e.payment_status)},prefillForm:function(e){void 0!==this.$popupParams.name&&(e.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),o.G.show(i.default)},loadCustomerOrders:function(e){var t=this;n.ih.get("/api/nexopos/v4/customers/".concat(e,"/orders")).subscribe((function(e){t.orders=e}))},newTransaction:function(e){new Promise((function(t,r){o.G.show(d,{customer:e,resolve:t,reject:r})})).then((function(t){POS.loadCustomer(e.id).subscribe((function(e){POS.selectCustomer(e)}))}))},applyCoupon:function(e){var t=this;void 0===this.order.customer?o.G.show(_.default,{title:(0,c.__)("Use Customer ?"),message:(0,c.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(r){r&&POS.selectCustomer(t.customer).then((function(r){t.proceedApplyingCoupon(e)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(e):this.order.customer.id!==this.customer.id&&o.G.show(_.default,{title:(0,c.__)("Change Customer ?"),message:(0,c.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(r){r&&POS.selectCustomer(t.customer).then((function(r){t.proceedApplyingCoupon(e)}))}})},proceedApplyingCoupon:function(e){var t=this;new Promise((function(t,r){o.G.show(p.default,{apply_coupon:e.code,resolve:t,reject:r})})).then((function(e){t.popupResolver(!1)})).catch((function(e){}))},handleSavedCustomer:function(e){n.kX.success(e.message).subscribe(),POS.selectCustomer(e.entry),this.$popup.close()}}};const v=(0,u.Z)(b,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow-lg rounded w-95vw h-95vh lg:w-3/5-screen flex flex-col overflow-hidden"},[r("div",{staticClass:"p-2 flex justify-between items-center border-b border-gray-400"},[r("h3",{staticClass:"font-semibold text-gray-700"},[e._v(e._s(e.__("Customers")))]),e._v(" "),r("div",[r("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),r("div",{staticClass:"flex-auto flex p-2 bg-gray-200 overflow-y-auto"},[r("ns-tabs",{attrs:{active:e.activeTab},on:{active:function(t){e.activeTab=t}}},[r("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===e.options.ns_pos_customers_creation_enabled?r("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(t){return e.prefillForm(t)},save:function(t){return e.handleSavedCustomer(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[e._v(e._s(e.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):e._e(),e._v(" "),r("div",{staticClass:"h-full flex-col w-full flex items-center justify-center"},[r("i",{staticClass:"lar la-hand-paper text-6xl text-gray-700"}),e._v(" "),r("h3",{staticClass:"font-medium text-2xl text-gray-700"},[e._v(e._s(e.__("Not Authorized")))]),e._v(" "),r("p",{staticClass:"text-gray-600"},[e._v(e._s(e.__("Creating customers has been explicitly disabled from the settings.")))])])],1),e._v(" "),r("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:e.__("Customer Account")}},[null===e.customer?r("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[r("i",{staticClass:"lar la-frown text-6xl text-gray-700"}),e._v(" "),r("h3",{staticClass:"font-medium text-2xl text-gray-700"},[e._v(e._s(e.__("No Customer Selected")))]),e._v(" "),r("p",{staticClass:"text-gray-600"},[e._v(e._s(e.__("In order to see a customer account, you need to select one customer.")))]),e._v(" "),r("div",{staticClass:"my-2"},[r("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.openCustomerSelection()}}},[e._v(e._s(e.__("Select Customer")))])],1)]):e._e(),e._v(" "),e.customer?r("div",{staticClass:"flex flex-col flex-auto"},[r("div",{staticClass:"flex-auto p-2 flex flex-col"},[r("div",{staticClass:"-mx-4 flex flex-wrap"},[r("div",{staticClass:"px-4 mb-4 w-full"},[r("h2",{staticClass:"font-semibold text-gray-700"},[e._v(e._s(e.__("Summary For"))+" : "+e._s(e.customer.name))])]),e._v(" "),r("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[r("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-green-400 to-green-700 p-2 flex flex-col text-white"},[r("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Purchases")))]),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.purchases_amount)))])])])]),e._v(" "),r("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[r("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-red-500 to-red-700 p-2 text-white"},[r("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Owed")))]),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.owed_amount)))])])])]),e._v(" "),r("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[r("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-blue-500 to-blue-700 p-2 text-white"},[r("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Account Amount")))]),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.account_amount)))])])])]),e._v(" "),r("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[r("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-teal-500 to-teal-700 p-2 text-white"},[r("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Credit Limit")))]),e._v(" "),r("div",{staticClass:"w-full flex justify-end"},[r("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.credit_limit_amount)))])])])])]),e._v(" "),r("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[r("ns-tabs",{attrs:{active:e.selectedTab},on:{changeTab:function(t){return e.doChangeTab(t)}}},[r("ns-tabs-item",{attrs:{identifier:"orders",label:e.__("Orders")}},[r("div",{staticClass:"py-2 w-full"},[r("h2",{staticClass:"font-semibold text-gray-700"},[e._v(e._s(e.__("Last Purchases")))])]),e._v(" "),r("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[r("div",{staticClass:"flex-auto overflow-y-auto"},[r("table",{staticClass:"table w-full"},[r("thead",[r("tr",{staticClass:"text-gray-700"},[r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Order")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[e._v(e._s(e.__("Total")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[e._v(e._s(e.__("Status")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"50"}},[e._v(e._s(e.__("Options")))])])]),e._v(" "),r("tbody",{staticClass:"text-gray-700"},[0===e.orders.length?r("tr",[r("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No orders...")))])]):e._e(),e._v(" "),e._l(e.orders,(function(t){return r("tr",{key:t.id},[r("td",{staticClass:"border border-gray-200 p-2 text-center"},[e._v(e._s(t.code))]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2 text-center"},[e._v(e._s(e._f("currency")(t.total)))]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2 text-right"},[e._v(e._s(t.human_status))]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2 text-center"},[e.allowedForPayment(t)?r("button",{staticClass:"hover:bg-blue-400 hover:border-transparent hover:text-white rounded-full h-8 px-2 flex items-center justify-center border border-gray bg-white"},[r("i",{staticClass:"las la-wallet"}),e._v(" "),r("span",{staticClass:"ml-1"},[e._v(e._s(e.__("Payment")))])]):e._e()])])}))],2)])])])]),e._v(" "),r("ns-tabs-item",{attrs:{identifier:"coupons",label:e.__("Coupons")}},[e.isLoadingCoupons?r("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[r("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingCoupons?e._e():[r("div",{staticClass:"py-2 w-full"},[r("h2",{staticClass:"font-semibold text-gray-700"},[e._v(e._s(e.__("Coupons")))])]),e._v(" "),r("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[r("div",{staticClass:"flex-auto overflow-y-auto"},[r("table",{staticClass:"table w-full"},[r("thead",[r("tr",{staticClass:"text-gray-700"},[r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[e._v(e._s(e.__("Type")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"})])]),e._v(" "),r("tbody",{staticClass:"text-gray-700 text-sm"},[0===e.coupons.length?r("tr",[r("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No coupons for the selected customer...")))])]):e._e(),e._v(" "),e._l(e.coupons,(function(t){return r("tr",{key:t.id},[r("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[r("h3",[e._v(e._s(t.name))]),e._v(" "),r("div",{},[r("ul",{staticClass:"-mx-2 flex"},[r("li",{staticClass:"text-xs text-gray-600 px-2"},[e._v(e._s(e.__("Usage :"))+" "+e._s(t.usage)+"/"+e._s(t.limit_usage))]),e._v(" "),r("li",{staticClass:"text-xs text-gray-600 px-2"},[e._v(e._s(e.__("Code :"))+" "+e._s(t.code))])])])]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2 text-center"},[e._v(e._s(e.getType(t.coupon.type))+" \n                                                                "),"percentage_discount"===t.coupon.type?r("span",[e._v("\n                                                                    ("+e._s(t.coupon.discount_value)+"%)\n                                                                ")]):e._e(),e._v(" "),"flat_discount"===t.coupon.type?r("span",[e._v("\n                                                                    ("+e._s(e._f("currency")(t.coupon.discount_value))+")\n                                                                ")]):e._e()]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2 text-right"},[r("ns-button",{attrs:{type:"info"},on:{click:function(r){return e.applyCoupon(t)}}},[e._v(e._s(e.__("Use Coupon")))])],1)])}))],2)])])])]],2),e._v(" "),r("ns-tabs-item",{attrs:{identifier:"rewards",label:e.__("Rewards")}},[e.isLoadingRewards?r("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[r("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingRewards?e._e():[r("div",{staticClass:"py-2 w-full"},[r("h2",{staticClass:"font-semibold text-gray-700"},[e._v(e._s(e.__("Rewards")))])]),e._v(" "),r("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[r("div",{staticClass:"flex-auto overflow-y-auto"},[r("table",{staticClass:"table w-full"},[r("thead",[r("tr",{staticClass:"text-gray-700"},[r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[e._v(e._s(e.__("Points")))]),e._v(" "),r("th",{staticClass:"p-2 border border-gray-200 bg-gray-100 font-semibold"},[e._v(e._s(e.__("Target")))])])]),e._v(" "),e.rewardsResponse.data?r("tbody",{staticClass:"text-gray-700 text-sm"},[0===e.rewardsResponse.data.length?r("tr",[r("td",{staticClass:"border border-gray-200 p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No rewards available the selected customer...")))])]):e._e(),e._v(" "),e._l(e.rewardsResponse.data,(function(t){return r("tr",{key:t.id},[r("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[r("h3",{staticClass:"text-center"},[e._v(e._s(t.reward_name))])]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[r("h3",{staticClass:"text-center"},[e._v(e._s(t.points))])]),e._v(" "),r("td",{staticClass:"border border-gray-200 p-2",attrs:{width:"300"}},[r("h3",{staticClass:"text-center"},[e._v(e._s(t.target))])])])}))],2):e._e()])])]),e._v(" "),r("div",{staticClass:"py-1 flex justify-end"},[r("ns-paginate",{attrs:{pagination:e.rewardsResponse},on:{load:function(t){return e.loadRewards(t)}}})],1)]],2)],1)],1)]),e._v(" "),r("div",{staticClass:"p-2 border-t border-gray-400 flex justify-between"},[r("div"),e._v(" "),r("div",[r("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.newTransaction(e.customer)}}},[e._v(e._s(e.__("Account Transaction")))])],1)])]):e._e()])],1)],1)])}),[],!1,null,null,null).exports},3768:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});function s(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}const o={name:"ns-pos-discount-popup",data:function(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[].concat(s([7,8,9].map((function(e){return{identifier:e,value:e}}))),s([4,5,6].map((function(e){return{identifier:e,value:e}}))),s([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.mode=this.$popupParams.reference.discount_type||"percentage",this.type=this.$popupParams.type,"percentage"===this.mode?this.finalValue=this.$popupParams.reference.discount_percentage||1:this.finalValue=this.$popupParams.reference.discount||1,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.$popup.close()}))},methods:{__:r(7389).__,setPercentageType:function(e){this.mode=e},inputValue:function(e){"next"===e.identifier?(this.$popupParams.onSubmit({discount_type:this.mode,discount_percentage:"percentage"===this.mode?this.finalValue:void 0,discount:"flat"===this.mode?this.finalValue:void 0}),this.$popup.close()):"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue),"percentage"===this.mode&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}};const i=(0,r(1900).Z)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative",attrs:{id:"discount-popup"}},[r("div",{staticClass:"flex-shrink-0 py-2 border-b border-gray-200"},["product"===e.type?r("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v(e._s(e.__("Product Discount")))]):e._e(),e._v(" "),"cart"===e.type?r("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v(e._s(e.__("Cart Discount")))]):e._e()]),e._v(" "),r("div",{staticClass:"h-16 bg-gray-800 text-white border-gray-200 flex items-center justify-center",attrs:{id:"screen"}},[r("h1",{staticClass:"font-bold text-3xl"},["flat"===e.mode?r("span",[e._v(e._s(e._f("currency")(e.finalValue)))]):e._e(),e._v(" "),"percentage"===e.mode?r("span",[e._v(e._s(e.finalValue)+"%")]):e._e()])]),e._v(" "),r("div",{staticClass:"flex",attrs:{id:"switch-mode"}},[r("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"flat"===e.mode?"bg-gray-800 text-white":"",on:{click:function(t){return e.setPercentageType("flat")}}},[e._v(e._s(e.__("Flat")))]),e._v(" "),r("hr",{staticClass:"border-r border-gray-200"}),e._v(" "),r("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"percentage"===e.mode?"bg-gray-800 text-white":"",on:{click:function(t){return e.setPercentageType("percentage")}}},[e._v(e._s(e.__("Percentage")))])]),e._v(" "),r("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,s){return r("div",{key:s,staticClass:"hover:bg-blue-400 hover:text-white hover:border-blue-600 text-xl font-bold border border-gray-200 h-24 flex items-center justify-center cursor-pointer",on:{click:function(r){return e.inputValue(t)}}},[void 0!==t.value?r("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?r("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports},2004:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});const s={name:"ns-pos-loading-popup"};const n=(0,r(1900).Z)(s,(function(){var e=this.$createElement;return(this._self._c||e)("ns-spinner")}),[],!1,null,null,null).exports},2600:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var s=r(7757),n=r.n(s),o=r(6386);function i(e,t,r,s,n,o,i){try{var a=e[o](i),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(s,n)}const a={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(t){e.types=t,1===Object.values(e.types).length&&e.select(Object.keys(e.types)[0])}))},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:r(7389).__,resolveIfQueued:o.Z,select:function(e){var t,r=this;return(t=n().mark((function t(){var s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.values(r.types).forEach((function(e){return e.selected=!1})),r.types[e].selected=!0,s=r.types[e],t.prev=3,t.next=6,POS.triggerOrderTypeSelection(s);case 6:t.sent,POS.types.next(r.types),r.resolveIfQueued(s),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(3);case 13:case"end":return t.stop()}}),t,null,[[3,11]])})),function(){var e=this,r=arguments;return new Promise((function(s,n){var o=t.apply(e,r);function a(e){i(o,s,n,a,c,"next",e)}function c(e){i(o,s,n,a,c,"throw",e)}a(void 0)}))})()}}};const c=(0,r(1900).Z)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen bg-white shadow-lg"},[r("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[r("h3",{staticClass:"font-bold text-gray-700"},[e._v(e._s(e.__("Define The Order Type")))])]),e._v(" "),0===Object.values(e.types).length?r("div",{staticClass:"grid grid-flow-row grid-cols-1 grid-rows-1"},[r("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[r("i",{staticClass:"las la-frown text-7xl text-red-400"}),e._v(" "),r("div",{staticClass:"p-4 md:w-2/3"},[r("p",{staticClass:"text-center text-gray-600"},[e._v(e._s(e.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),e._v(" "),r("div",{staticClass:"flex justify-center py-1"},[r("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[e._v(e._s(e.__("Read More")))])],1)])])]):e._e(),e._v(" "),Object.values(e.types).length>0?r("div",{staticClass:"grid grid-flow-row grid-cols-2 grid-rows-2"},e._l(e.types,(function(t){return r("div",{key:t.identifier,staticClass:"hover:bg-blue-100 h-56 flex items-center justify-center flex-col cursor-pointer border border-gray-200",class:t.selected?"bg-blue-100":"",on:{click:function(r){return e.select(t.identifier)}}},[r("img",{staticClass:"w-32 h-32",attrs:{src:t.icon,alt:""}}),e._v(" "),r("h4",{staticClass:"font-semibold text-xl my-2 text-gray-700"},[e._v(e._s(t.label))])])})),0):e._e()])}),[],!1,null,null,null).exports},4916:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var s=r(6386),n=r(2242),o=r(3768),i=r(1096),a=r(7389);function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}const u={name:"sample-payment",props:["label","identifier"],data:function(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join("")),order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(c([7,8,9].map((function(e){return{identifier:e,value:e}}))),c([4,5,6].map((function(e){return{identifier:e,value:e}}))),c([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.orderSubscription=POS.order.subscribe((function(t){e.order=t}))},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:a.__,toggleDiscount:function(){var e=this;n.G.show(o.default,{reference:this.order,type:"cart",onSubmit:function(t){POS.updateCart(e.order,t)}})},makeFullPayment:function(){var e=this;n.G.show(i.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("A full payment will be made using {paymentType} for {total}").replace("{paymentType}",this.label).replace("{total}",this.$options.filters.currency(this.order.total)),onAction:function(t){if(t){var r=POS.order.getValue();r.tendered<r.total&&POS.addPayment({value:e.order.total-r.tendered,identifier:e.identifier,selected:!1,label:e.label,readonly:!1}),e.$emit("submit"),e.backValue="0"}}})},increaseBy:function(e){var t=parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));this.backValue=(parseFloat(e.value)*t+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue:function(e){parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));"next"===e.identifier?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):"backspace"===e.identifier?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):e.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=e.value.toString(),this.allSelected=!1):(this.backValue+=e.value.toString(),"percentage"===this.mode&&(this.backValue=this.backValue>100?100:this.backValue))),"0"===this.backValue&&(this.backValue="")}}};var d=r(1900);const p=(0,d.Z)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full w-full py-2"},[e.order?r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"grid grid-cols-2 gap-2"},[r("div",{staticClass:"h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[r("span",[e._v(e._s(e.__("Total"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),r("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-red-400 text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[r("span",[e._v(e._s(e.__("Discount"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-green-400 text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[r("span",[e._v(e._s(e.__("Paid"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-teal-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v(e._s(e.__("Change"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-gray-300 text-gray-800 text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v(e._s(e.__("Screen"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.backValue/e.number)))])])])]):e._e(),e._v(" "),r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"-mx-2 flex flex-wrap"},[r("div",{staticClass:"pl-2 pr-1 flex-auto"},[r("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[e._l(e.keys,(function(t,s){return r("div",{key:s,staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(r){return e.inputValue(t)}}},[void 0!==t.value?r("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?r("i",{staticClass:"las",class:t.icon}):e._e()])})),e._v(" "),r("div",{staticClass:"hover:bg-green-500 col-span-3 bg-green-400 text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        "+e._s(e.__("Full Payment")))])],2)]),e._v(" "),r("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[r("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[r("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[r("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[r("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports,_={name:"cash-payment",props:["identifier","label"],components:{samplePayment:p}};const f=(0,d.Z)(_,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:e.label},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports;const b={name:"creditcart-payment",props:["identifier"]};const v=(0,d.Z)(b,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("h1",[e._v("Credit Card")])}),[],!1,null,null,null).exports;const h={name:"bank-payment",props:["identifier","label"],components:{samplePayment:p}};const m=(0,d.Z)(h,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:e.label},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports;var y=r(9499),g=r(9671);const x={name:"ns-account-payment",components:{nsNumpad:y.Z},props:["identifier","label"],data:function(){return{subscription:null,screenValue:0,order:null}},methods:{__:a.__,handleChange:function(e){this.screenValue=e},proceedAddingPayment:function(e){var t=parseFloat(e),r=this.order.payments;return t<=0?g.kX.error((0,a.__)("Please provide a valid payment amount.")).subscribe():r.filter((function(e){return"account-payment"===e.identifier})).length>0?g.kX.error((0,a.__)("The customer account can only be used once per order. Consider deleting the previously used payment.")).subscribe():t>this.order.customer.account_amount?g.kX.error((0,a.__)("Not enough funds to add {amount} as a payment. Available balance {balance}.").replace("{amount}",this.$options.filters.currency(t)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe():(POS.addPayment({value:t,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=t,POS.selectCustomer(this.order.customer),void this.$emit("submit"))},proceedFullPayment:function(){this.proceedAddingPayment(this.order.total)},makeFullPayment:function(){var e=this;Popup.show(i.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:function(t){t&&e.proceedFullPayment()}})}},mounted:function(){var e=this;this.subscription=POS.order.subscribe((function(t){return e.order=t}))},destroyed:function(){this.subscription.unsubscribe()}};const C=(0,d.Z)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"h-full w-full py-2"},[e.order?r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"grid grid-cols-2 gap-2"},[r("div",{staticClass:"h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[r("span",[e._v(e._s(e.__("Total"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),r("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-red-400 text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[r("span",[e._v(e._s(e.__("Discount"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-green-400 text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[r("span",[e._v(e._s(e.__("Paid"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),r("div",{staticClass:"h-16 flex justify-between items-center bg-teal-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v(e._s(e.__("Change"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-blue-400 text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v(e._s(e.__("Current Balance"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.order.customer.account_amount)))])]),e._v(" "),r("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-gray-300 text-gray-800 text-xl md:text-3xl p-2",attrs:{id:"change"}},[r("span",[e._v(e._s(e.__("Screen"))+" : ")]),e._v(" "),r("span",[e._v(e._s(e._f("currency")(e.screenValue)))])])])]):e._e(),e._v(" "),r("div",{staticClass:"px-2 pb-2"},[r("div",{staticClass:"-mx-2 flex flex-wrap"},[r("div",{staticClass:"pl-2 pr-1 flex-auto"},[r("ns-numpad",{attrs:{floating:!0},on:{changed:function(t){return e.handleChange(t)},next:function(t){return e.proceedAddingPayment(t)}},scopedSlots:e._u([{key:"numpad-footer",fn:function(){return[r("div",{staticClass:"hover:bg-green-500 col-span-3 bg-green-400 text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        "+e._s(e.__("Full Payment")))])]},proxy:!0}])})],1),e._v(" "),r("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[r("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[r("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[r("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),r("div",{staticClass:"hover:bg-gray-400 hover:text-gray-800 bg-gray-300 text-2xl text-gray-700 border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[r("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports;var w=r(2004);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const O={name:"ns-pos-payment",data:function(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null}},computed:{activePayment:function(){var e;return(e=this.paymentsType.filter((function(e){return e.selected}))).length>0&&e[0]},expectedPayment:function(){var e=this.order.customer.group.minimal_credit_payment;return this.order.total*e/100}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){if("click-overlay"===t.event)e.closePopup()})),this.order=this.$popupParams.order,this.paymentTypesSubscription=POS.paymentsType.subscribe((function(t){e.paymentsType=t,t.filter((function(e){e.selected&&POS.selectedPaymentType.next(e)}))}))},watch:{activePayment:function(e){this.loadPaymentComponent(e)}},destroyed:function(){this.paymentTypesSubscription.unsubscribe()},methods:{__:a.__,resolveIfQueued:s.Z,loadPaymentComponent:function(e){switch(e.identifier){case"cash-payment":this.currentPaymentComponent=f;break;case"creditcard-payment":this.currentPaymentComponent=v;break;case"bank-payment":this.currentPaymentComponent=m;break;case"account-payment":this.currentPaymentComponent=C;break;default:this.currentPaymentComponent=p}},select:function(e){this.showPayment=!1,POS.setPaymentActive(e)},closePopup:function(){this.$popup.close(),POS.selectedPaymentType.next(null)},deletePayment:function(e){POS.removePayment(e)},selectPaymentAsActive:function(e){this.select(this.paymentsType.filter((function(t){return t.identifier===e.target.value}))[0])},submitOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.G.show(w.default);try{var s=P(P({},POS.order.getValue()),t);POS.submitOrder(s).then((function(t){r.close(),g.kX.success(t.message).subscribe(),POS.printOrderReceipt(t.data.order),e.$popup.close()}),(function(e){r.close(),g.kX.error(e.message).subscribe()}))}catch(e){r.close(),g.kX.error(error.message).subscribe()}}}};const j=(0,d.Z)(O,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.order?r("div",{staticClass:"w-screen h-screen p-4 flex overflow-hidden"},[r("div",{staticClass:"flex flex-col flex-auto lg:flex-row bg-white shadow-xl"},[r("div",{staticClass:"w-full lg:w-56 bg-gray-300 lg:h-full flex justify-between px-2 lg:px-0 lg:block items-center lg:items-start"},[r("h3",{staticClass:"text-xl text-center my-4 font-bold lg:my-8 text-gray-700"},[e._v(e._s(e.__("Payments Gateway")))]),e._v(" "),r("ul",{staticClass:"hidden lg:block"},[e._l(e.paymentsType,(function(t){return r("li",{key:t.identifier,staticClass:"cursor-pointer hover:bg-gray-400 py-2 px-3",class:t.selected&&!e.showPayment?"bg-white text-gray-800":"text-gray-700",on:{click:function(r){return e.select(t)}}},[e._v(e._s(t.label))])})),e._v(" "),r("li",{staticClass:"cursor-pointer text-gray-700 hover:bg-gray-400 py-2 px-3 border-t border-gray-400 mt-4 flex items-center justify-between",class:e.showPayment?"bg-white text-gray-800":"text-gray-700",on:{click:function(t){e.showPayment=!0}}},[r("span",[e._v(e._s(e.__("Payment List")))]),e._v(" "),r("span",{staticClass:"px-2 rounded-full h-8 w-8 flex items-center justify-center bg-green-500 text-white"},[e._v(e._s(e.order.payments.length))])])],2),e._v(" "),r("ns-close-button",{staticClass:"lg:hidden",on:{click:function(t){return e.closePopup()}}})],1),e._v(" "),r("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[r("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[r("div",{staticClass:"h-12 bg-gray-300 hidden items-center justify-between lg:flex"},[r("div"),e._v(" "),r("div",{staticClass:"px-2"},[r("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),e.showPayment?e._e():r("div",{staticClass:"flex flex-auto overflow-y-auto"},[r(e.currentPaymentComponent,{tag:"component",attrs:{label:e.activePayment.label,identifier:e.activePayment.identifier},on:{submit:function(t){return e.submitOrder()}}})],1),e._v(" "),e.showPayment?r("div",{staticClass:"flex flex-auto overflow-y-auto p-2 flex-col"},[r("h3",{staticClass:"text-center font-bold py-2 text-gray-700"},[e._v(e._s(e.__("List Of Payments")))]),e._v(" "),r("ul",{staticClass:"flex-auto"},[0===e.order.payments.length?r("li",{staticClass:"p-2 bg-gray-200 flex justify-center mb-2 items-center"},[r("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("No Payment added.")))])]):e._e(),e._v(" "),e._l(e.order.payments,(function(t,s){return r("li",{key:s,staticClass:"p-2 bg-gray-200 flex justify-between mb-2 items-center"},[r("span",[e._v(e._s(t.label))]),e._v(" "),r("div",{staticClass:"flex items-center"},[r("span",[e._v(e._s(e._f("currency")(t.value)))]),e._v(" "),r("button",{staticClass:"rounded-full bg-red-400 h-8 w-8 flex items-center justify-center text-white ml-2",on:{click:function(r){return e.deletePayment(t)}}},[r("i",{staticClass:"las la-trash-alt"})])])])}))],2)]):e._e()]),e._v(" "),r("div",{staticClass:"flex flex-col lg:flex-row w-full bg-gray-300 justify-between p-2"},[r("div",{staticClass:"flex mb-1"},[r("div",{staticClass:"flex items-center lg:hidden"},[r("h3",{staticClass:"font-semibold mr-2"},[e._v(e._s(e.__("Select Payment")))]),e._v(" "),r("select",{staticClass:"p-2 rounded border-2 border-blue-400 bg-white shadow",on:{change:function(t){return e.selectPaymentAsActive(t)}}},[r("option",{attrs:{value:""}},[e._v(e._s(e.__("Choose Payment")))]),e._v(" "),e._l(e.paymentsType,(function(t){return r("option",{key:t.identifier,domProps:{selected:e.activePayment.identifier===t.identifier,value:t.identifier},on:{click:function(r){return e.select(t)}}},[e._v(e._s(t.label))])}))],2)])]),e._v(" "),r("div",{staticClass:"flex justify-end"},[e.order.tendered>=e.order.total?r("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder()}}},[r("span",[r("i",{staticClass:"las la-cash-register"}),e._v(" "+e._s(e.__("Submit Payment")))])]):e._e(),e._v(" "),e.order.tendered<e.order.total?r("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder({payment_status:"unpaid"})}}},[r("span",[r("i",{staticClass:"las la-bookmark"}),e._v(" "+e._s(e.__("Layaway"))+" — "+e._s(e._f("currency")(e.expectedPayment)))])]):e._e()],1)])])])]):e._e()}),[],!1,null,null,null).exports},2245:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var s=r(9671),n=r(7389);function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}const a={data:function(){return{finalValue:1,virtualStock:null,allSelected:!0,isLoading:!1,keys:[].concat(o([1,2,3].map((function(e){return{identifier:e,value:e}}))),o([4,5,6].map((function(e){return{identifier:e,value:e}}))),o([7,8,9].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),document.addEventListener("keyup",this.handleKeyPress)},destroyed:function(){document.removeEventListener("keypress",this.handleKeyPress)},methods:{__:n.__,handleKeyPress:function(e){13===e.keyCode&&this.inputValue({identifier:"next"})},inputValue:function(e){if("next"===e.identifier){var t=this.$popupParams,r=t.product,o=t.data,i=parseFloat(this.finalValue);if(0===i)return s.kX.error((0,n.__)("Please provide a quantity")).subscribe();if("enabled"===r.$original().stock_management){var a=POS.getStockUsage(r.$original().id,o.unit_quantity_id)-(r.quantity||0);if(i>parseFloat(o.$quantities().quantity)-a)return s.kX.error((0,n.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",o.$quantities().quantity-a)).subscribe()}this.resolve({quantity:i})}else"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue))},resolve:function(e){this.$popupParams.resolve(e),this.$popup.close()}}};const c=(0,r(1900).Z)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-white shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[e.isLoading?r("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[r("ns-spinner")],1):e._e(),e._v(" "),r("div",{staticClass:"flex-shrink-0 py-2 border-b border-gray-200"},[r("h1",{staticClass:"text-xl font-bold text-gray-700 text-center"},[e._v(e._s(e.__("Define Quantity")))])]),e._v(" "),r("div",{staticClass:"h-16 border-b bg-gray-800 text-white border-gray-200 flex items-center justify-center",attrs:{id:"screen"}},[r("h1",{staticClass:"font-bold text-3xl"},[e._v(e._s(e.finalValue))])]),e._v(" "),r("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,s){return r("div",{key:s,staticClass:"hover:bg-blue-400 hover:text-white hover:border-blue-600 text-xl font-bold border border-gray-200 h-24 flex items-center justify-center cursor-pointer",on:{click:function(r){return e.inputValue(t)}}},[void 0!==t.value?r("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?r("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports}}]);