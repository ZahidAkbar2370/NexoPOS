"use strict";(self.webpackChunkNexoPOS_4x=self.webpackChunkNexoPOS_4x||[]).push([[261,4,600,935],{9763:(e,t,s)=>{function r(e){POS.changeVisibleSection(e)}s.d(t,{Z:()=>r})},279:(e,t,s)=>{s.d(t,{$:()=>c});var r=s(9671),n=s(7389),i=s(2242),o=s(567);function a(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.product=t}var t,s,c;return t=e,(s=[{key:"run",value:function(e){var t=this;return new Promise((function(s,a){var c=new i.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),l=t.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===l.$original().stock_management){var u=POS.getStockUsage(l.$original().id,e.unit_quantity_id)-(l.quantity||0);if(1>parseFloat(e.$quantities().quantity)-u)return r.kX.error((0,n.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(e.$quantities().quantity-u).toString())).subscribe()}s({quantity:1})}else c.open(o.Z,{resolve:s,reject:a,product:l,data:e})}))}}])&&a(t.prototype,s),c&&a(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5600:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ye});var r=s(7757),n=s.n(r),i=s(2242),o=s(6386),a=s(7389);function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}const u={name:"ns-pos-discount-popup",data:function(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[].concat(c([7,8,9].map((function(e){return{identifier:e,value:e}}))),c([4,5,6].map((function(e){return{identifier:e,value:e}}))),c([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.mode=this.$popupParams.reference.discount_type||"percentage",this.type=this.$popupParams.type,"percentage"===this.mode?this.finalValue=this.$popupParams.reference.discount_percentage||1:this.finalValue=this.$popupParams.reference.discount||1,this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.$popup.close()}))},methods:{__:a.__,setPercentageType:function(e){this.mode=e},closePopup:function(){this.$popup.close()},inputValue:function(e){"next"===e.identifier?(this.$popupParams.onSubmit({discount_type:this.mode,discount_percentage:"percentage"===this.mode?this.finalValue:void 0,discount:"flat"===this.mode?this.finalValue:void 0}),this.$popup.close()):"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue),"percentage"===this.mode&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}};var d=s(1900);const p=(0,d.Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative",attrs:{id:"discount-popup"}},[s("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[s("div",["product"===e.type?s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[e._v(e._s(e.__("Product Discount")))]):e._e(),e._v(" "),"cart"===e.type?s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[e._v(e._s(e.__("Cart Discount")))]):e._e()]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"h-16 ns-box-body text-white flex items-center justify-center",attrs:{id:"screen"}},[s("h1",{staticClass:"font-bold text-3xl"},["flat"===e.mode?s("span",[e._v(e._s(e._f("currency")(e.finalValue)))]):e._e(),e._v(" "),"percentage"===e.mode?s("span",[e._v(e._s(e.finalValue)+"%")]):e._e()])]),e._v(" "),s("div",{staticClass:"flex",attrs:{id:"switch-mode"}},[s("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"flat"===e.mode?"bg-tab-active text-white":"bg-tab-inactive text-tertiary",on:{click:function(t){return e.setPercentageType("flat")}}},[e._v(e._s(e.__("Flat")))]),e._v(" "),s("hr",{staticClass:"border-r border-box-edge"}),e._v(" "),s("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"percentage"===e.mode?"bg-tab-active text-white":"bg-tab-inactive text-tertiary",on:{click:function(t){return e.setPercentageType("percentage")}}},[e._v(e._s(e.__("Percentage")))])]),e._v(" "),s("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,r){return s("div",{key:r,staticClass:"text-primary ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer",on:{click:function(s){return e.inputValue(t)}}},[void 0!==t.value?s("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?s("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports;var f=s(4864);function _(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}const b={name:"sample-payment",props:["label","identifier"],data:function(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(e){return 0})).join("")),order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(_([7,8,9].map((function(e){return{identifier:e,value:e}}))),_([4,5,6].map((function(e){return{identifier:e,value:e}}))),_([1,2,3].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.orderSubscription=POS.order.subscribe((function(t){e.order=t}))},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:a.__,toggleDiscount:function(){var e=this;i.G.show(p,{reference:this.order,type:"cart",onSubmit:function(t){POS.updateCart(e.order,t)}})},makeFullPayment:function(){var e=this;i.G.show(f.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("A full payment will be made using {paymentType} for {total}").replace("{paymentType}",this.label).replace("{total}",this.$options.filters.currency(this.order.total)),onAction:function(t){if(t){var s=POS.order.getValue();s.tendered<s.total&&POS.addPayment({value:e.order.total-s.tendered,identifier:e.identifier,selected:!1,label:e.label,readonly:!1}),e.$emit("submit"),e.backValue="0"}}})},increaseBy:function(e){var t=parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));this.backValue=(parseFloat(e.value)*t+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue:function(e){parseInt(1+new Array(this.cursor).fill("").map((function(e){return 0})).join(""));"next"===e.identifier?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):"backspace"===e.identifier?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):e.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=e.value.toString(),this.allSelected=!1):(this.backValue+=e.value.toString(),"percentage"===this.mode&&(this.backValue=this.backValue>100?100:this.backValue))),"0"===this.backValue&&(this.backValue="")}}};const h=(0,d.Z)(b,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full w-full py-2"},[e.order?s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"grid grid-cols-2 gap-2"},[s("div",{staticClass:"h-16 flex justify-between items-center bg-info-primary text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[s("span",[e._v(e._s(e.__("Total"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),s("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-error-primary text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[s("span",[e._v(e._s(e.__("Discount"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center bg-success-primary text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[s("span",[e._v(e._s(e.__("Paid"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center bg-warning-primary text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[e._v(e._s(e.__("Change"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),s("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[e._v(e._s(e.__("Screen"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.backValue/e.number)))])])])]):e._e(),e._v(" "),s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"pl-2 pr-1 flex-auto"},[s("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[e._l(e.keys,(function(t,r){return s("div",{key:r,staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(s){return e.inputValue(t)}}},[void 0!==t.value?s("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?s("i",{staticClass:"las",class:t.icon}):e._e()])})),e._v(" "),s("div",{staticClass:"hover:bg-green-500 col-span-3 bg-success-secondary border-success-tertiary text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        "+e._s(e.__("Full Payment")))])],2)]),e._v(" "),s("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[s("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[s("div",{staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[s("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),s("div",{staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[s("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),s("div",{staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[s("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports,m={name:"cash-payment",props:["identifier","label"],components:{samplePayment:h}};const y=(0,d.Z)(m,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:e.label},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports;const x={name:"creditcart-payment",props:["identifier"]};const g=(0,d.Z)(x,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("h1",[e._v("Credit Card")])}),[],!1,null,null,null).exports;const C={name:"bank-payment",props:["identifier","label"],components:{samplePayment:h}};const w=(0,d.Z)(C,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("sample-payment",{attrs:{identifier:e.identifier,label:e.label},on:{submit:function(t){return e.$emit("submit")}}})}),[],!1,null,null,null).exports;var k=s(4211),P=s(9671);const S={name:"ns-account-payment",components:{nsNumpad:k.Z},props:["identifier","label"],data:function(){return{subscription:null,screenValue:0,order:null}},methods:{__:a.__,handleChange:function(e){this.screenValue=e},proceedAddingPayment:function(e){var t=parseFloat(e),s=this.order.payments;return t<=0?P.kX.error((0,a.__)("Please provide a valid payment amount.")).subscribe():s.filter((function(e){return"account-payment"===e.identifier})).length>0?P.kX.error((0,a.__)("The customer account can only be used once per order. Consider deleting the previously used payment.")).subscribe():t>this.order.customer.account_amount?P.kX.error((0,a.__)("Not enough funds to add {amount} as a payment. Available balance {balance}.").replace("{amount}",this.$options.filters.currency(t)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe():(POS.addPayment({value:t,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=t,POS.selectCustomer(this.order.customer),void this.$emit("submit"))},proceedFullPayment:function(){this.proceedAddingPayment(this.order.total)},makeFullPayment:function(){var e=this;Popup.show(f.default,{title:(0,a.__)("Confirm Full Payment"),message:(0,a.__)("You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:function(t){t&&e.proceedFullPayment()}})}},mounted:function(){var e=this;this.subscription=POS.order.subscribe((function(t){return e.order=t}))},destroyed:function(){this.subscription.unsubscribe()}};const O=(0,d.Z)(S,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full w-full py-2"},[e.order?s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"grid grid-cols-2 gap-2"},[s("div",{staticClass:"h-16 flex justify-between items-center bg-info-primary text-white text-xl md:text-3xl p-2",attrs:{id:"details"}},[s("span",[e._v(e._s(e.__("Total"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),s("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center bg-error-primary text-white text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(t){return e.toggleDiscount()}}},[s("span",[e._v(e._s(e.__("Discount"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.discount)))])]),e._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center bg-success-primary text-white text-xl md:text-3xl p-2",attrs:{id:"paid"}},[s("span",[e._v(e._s(e.__("Paid"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.tendered)))])]),e._v(" "),s("div",{staticClass:"h-16 flex justify-between items-center bg-warning-primary text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[e._v(e._s(e.__("Change"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.change)))])]),e._v(" "),s("div",{staticClass:"col-span-2 h-16 flex justify-between items-center bg-info-primary text-white text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[e._v(e._s(e.__("Current Balance"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.customer.account_amount)))])]),e._v(" "),s("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-primary text-xl md:text-3xl p-2",attrs:{id:"change"}},[s("span",[e._v(e._s(e.__("Screen"))+" : ")]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.screenValue)))])])])]):e._e(),e._v(" "),s("div",{staticClass:"px-2 pb-2"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"pl-2 pr-1 flex-auto"},[s("ns-numpad",{attrs:{floating:!0},on:{changed:function(t){return e.handleChange(t)},next:function(t){return e.proceedAddingPayment(t)}},scopedSlots:e._u([{key:"numpad-footer",fn:function(){return[s("div",{staticClass:"hover:bg-success-tertiary col-span-3 bg-success-secondary text-2xl text-white border border-success-secondary h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.makeFullPayment()}}},[e._v("\n                        "+e._s(e.__("Full Payment")))])]},proxy:!0}])})],1),e._v(" "),s("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[s("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:100})}}},[s("span",[e._v(e._s(e._f("currency")(100)))])]),e._v(" "),s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:500})}}},[s("span",[e._v(e._s(e._f("currency")(500)))])]),e._v(" "),s("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(t){return e.increaseBy({value:1e3})}}},[s("span",[e._v(e._s(e._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports;var j=s(2004),T=s(3472);function $(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function V(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?$(Object(s),!0).forEach((function(t){Z(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Z(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function A(e,t,s,r,n,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const F={name:"ns-pos-payment",data:function(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null}},computed:{activePayment:function(){var e;return(e=this.paymentsType.filter((function(e){return e.selected}))).length>0&&e[0]},expectedPayment:function(){var e=this.order.customer.group.minimal_credit_payment;return this.order.total*e/100}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){if("click-overlay"===t.event)e.closePopup()})),this.order=this.$popupParams.order,this.paymentTypesSubscription=POS.paymentsType.subscribe((function(t){e.paymentsType=t,t.filter((function(e){e.selected&&POS.selectedPaymentType.next(e)}))}))},watch:{activePayment:function(e){this.loadPaymentComponent(e)}},destroyed:function(){this.paymentTypesSubscription.unsubscribe()},methods:{__:a.__,resolveIfQueued:o.Z,loadPaymentComponent:function(e){switch(e.identifier){case"cash-payment":this.currentPaymentComponent=y;break;case"creditcard-payment":this.currentPaymentComponent=g;break;case"bank-payment":this.currentPaymentComponent=w;break;case"account-payment":this.currentPaymentComponent=O;break;default:this.currentPaymentComponent=h}},selectPayment:function(){var e,t=this;return(e=n().mark((function e(){var s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,s){i.G.show(T.Z,{label:(0,a.__)("Select Payment Gateway"),options:t.paymentsType.map((function(e){return{label:e.label,value:e.identifier}})),value:t.activePayment.identifier,resolve:e,reject:s})}));case 3:s=e.sent,t.select(t.paymentsType.filter((function(e){return e.identifier===s[0].value}))[0]),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function o(e){A(i,r,n,o,a,"next",e)}function a(e){A(i,r,n,o,a,"throw",e)}o(void 0)}))})()},select:function(e){this.showPayment=!1,POS.setPaymentActive(e)},closePopup:function(){this.$popup.close(),POS.selectedPaymentType.next(null)},deletePayment:function(e){POS.removePayment(e)},selectPaymentAsActive:function(e){this.select(this.paymentsType.filter((function(t){return t.identifier===e.target.value}))[0])},submitOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=i.G.show(j.default);try{var r=V(V({},POS.order.getValue()),t);POS.submitOrder(r).then((function(t){s.close(),P.kX.success(t.message).subscribe(),POS.printOrderReceipt(t.data.order),e.$popup.close()}),(function(e){s.close(),P.kX.error(e.message).subscribe()}))}catch(e){s.close(),P.kX.error(error.message).subscribe()}}}};const E=(0,d.Z)(F,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.order?s("div",{staticClass:"w-screen h-screen p-4 flex overflow-hidden",attrs:{id:"ns-payment-popup"}},[s("div",{staticClass:"flex flex-col flex-auto lg:flex-row shadow-xl"},[s("div",{staticClass:"w-full lg:w-56 lg:h-full flex justify-between px-2 lg:px-0 lg:block items-center lg:items-start"},[s("h3",{staticClass:"lg:hidden text-xl text-center my-4 font-bold lg:my-8"},[e._v(e._s(e.__("Gateway"))+" "),s("span",[e._v(": "+e._s(e.activePayment.label))])]),e._v(" "),s("div",{staticClass:"h-16 hidden lg:block"}),e._v(" "),s("ul",{staticClass:"hidden lg:block"},[e._l(e.paymentsType,(function(t){return s("li",{key:t.identifier,staticClass:"cursor-pointer ns-payment-gateway py-2 px-3",class:t.selected&&!e.showPayment?"ns-visible":"",on:{click:function(s){return e.select(t)}}},[e._v(e._s(t.label))])})),e._v(" "),s("li",{staticClass:"cursor-pointer py-2 px-3 ns-payment-list border-t mt-4 flex items-center justify-between",class:e.showPayment?"ns-visible":"",on:{click:function(t){e.showPayment=!0}}},[s("span",[e._v(e._s(e.__("Payment List")))]),e._v(" "),s("span",{staticClass:"px-2 rounded-full h-8 w-8 flex items-center justify-center ns-label"},[e._v(e._s(e.order.payments.length))])])],2),e._v(" "),s("ns-close-button",{staticClass:"lg:hidden",on:{click:function(t){return e.closePopup()}}})],1),e._v(" "),s("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[s("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[s("div",{staticClass:"h-12 hidden items-center justify-between lg:flex"},[s("div",[s("h3",{staticClass:"text-xl hidden lg:block text-center my-4 font-bold lg:my-8"},[e._v(e._s(e.__("Gateway"))+" "),s("span",{staticClass:"hidden-md"},[e._v(": "+e._s(e.activePayment.label))])])]),e._v(" "),s("div",{staticClass:"px-2"},[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),e.showPayment?e._e():s("div",{staticClass:"flex flex-auto ns-payment-wrapper overflow-y-auto"},[s(e.currentPaymentComponent,{tag:"component",attrs:{label:e.activePayment.label,identifier:e.activePayment.identifier},on:{submit:function(t){return e.submitOrder()}}})],1),e._v(" "),e.showPayment?s("div",{staticClass:"flex flex-auto ns-payment-wrapper overflow-y-auto p-2 flex-col"},[s("h3",{staticClass:"text-center font-bold py-2"},[e._v(e._s(e.__("List Of Payments")))]),e._v(" "),s("ul",{staticClass:"flex-auto"},[0===e.order.payments.length?s("li",{staticClass:"p-2 flex justify-center mb-2 items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("No Payment added.")))])]):e._e(),e._v(" "),e._l(e.order.payments,(function(t,r){return s("li",{key:r,staticClass:"p-2 flex justify-between mb-2 items-center"},[s("span",[e._v(e._s(t.label))]),e._v(" "),s("div",{staticClass:"flex items-center"},[s("span",[e._v(e._s(e._f("currency")(t.value)))]),e._v(" "),s("button",{staticClass:"rounded-full  h-8 w-8 flex items-center justify-center ml-2",on:{click:function(s){return e.deletePayment(t)}}},[s("i",{staticClass:"las la-trash-alt"})])])])}))],2)]):e._e()]),e._v(" "),s("div",{staticClass:"flex lg:hidden ns-payment-buttons"},[s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 font-bold ns-payment-type-button",on:{click:function(t){return e.selectPayment()}}},[s("span",{staticClass:"text-sm"},[e._v(e._s(e.__("Payment Type")))])]),e._v(" "),e.order.tendered>=e.order.total?s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-submit-button font-bold",on:{click:function(t){return e.submitOrder()}}},[s("span",{staticClass:"text-sm"},[e._v(e._s(e.__("Submit Payment")))])]):e._e(),e._v(" "),e.order.tendered<e.order.total?s("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-layaway-button font-bold",on:{click:function(t){return e.submitOrder({payment_status:"unpaid"})}}},[s("span",{staticClass:"text-sm"},[e._v(e._s(e.__("Layaway")))])]):e._e(),e._v(" "),s("button",{staticClass:"w-1/3 flex ns-payment-button text-2xl flex-auto h-12 items-center justify-center font-bold",on:{click:function(t){e.showPayment=!0}}},[s("span",{staticClass:"text-sm mr-1"},[e._v(e._s(e.__("Payment List")))]),e._v(" "),s("span",{staticClass:"px-2 rounded-full h-6 w-6 text-xs flex items-center justify-center ns-label"},[e._v(e._s(e.order.payments.length))])])]),e._v(" "),s("div",{staticClass:"flex-col sm:flex-row w-full ns-payment-footer justify-end p-2 hidden lg:flex"},[s("div",{staticClass:"flex justify-end"},[e.order.tendered>=e.order.total?s("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder()}}},[s("span",[s("i",{staticClass:"las la-cash-register"}),e._v(" "+e._s(e.__("Submit Payment")))])]):e._e(),e._v(" "),e.order.tendered<e.order.total?s("ns-button",{attrs:{type:e.order.tendered>=e.order.total?"success":"info"},on:{click:function(t){return e.submitOrder({payment_status:"unpaid"})}}},[s("span",[s("i",{staticClass:"las la-bookmark"}),e._v(" "+e._s(e.__("Layaway"))+" — "+e._s(e._f("currency")(e.expectedPayment)))])]):e._e()],1)])])])]):e._e()}),[],!1,null,null,null).exports;s(567);var I=s(279),G=s(8680),q=s(2529);function N(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,s,r;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){return 0===e.order.products.length?(P.kX.error((0,a.__)("You need to provide some products before proceeding.")).subscribe(),s(!1)):t(!0)}))}}])&&N(t.prototype,s),r&&N(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}window.ProductsQueue=R;var L=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,s,r;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){return void 0===e.order.customer?i.G.show(q.Z,{resolve:t,reject:s}):t(!0)}))}}])&&D(t.prototype,s),r&&D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function X(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}window.CustomerQueue=L;var Q=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,s,r;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){i.G.show(E,{resolve:t,reject:s,order:e.order})}))}}])&&X(t.prototype,s),r&&X(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function W(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}window.PaymentQueue=Q;var H=s(8680).Z,U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=t}var t,s,r;return t=e,(s=[{key:"run",value:function(){var e=this;return new Promise((function(t,s){if(void 0===e.order.type)return i.G.show(H,{resolve:t,reject:s});t(!0)}))}}])&&W(t.prototype,s),r&&W(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.TypeQueue=U;var B=s(9763),z=s(9702),Y=s(8603);const M={name:"ns-pos-hold-orders",data:function(){return{order:{},title:"",show:!0}},mounted:function(){this.popupCloser(),this.show=POS.getHoldPopupEnabled(),this.show||this.$popupParams.resolve({title:this.title}),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.$popupParams.order,this.title=this.$popupParams.order.title||""},methods:{__:a.__,popupCloser:Y.Z,submitHold:function(){this.$popup.close(),this.$popupParams.resolve({title:this.title})}}};const K=(0,d.Z)(M,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},[s("div",{staticClass:"p-2 flex ns-box-header justify-between border-b items-center"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Hold Order")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto ns-box-body"},[s("div",{staticClass:"border-b h-16 flex items-center justify-center"},[s("span",{staticClass:"text-5xl text-primary"},[e._v(e._s(e._f("currency")(e.order.total)))])]),e._v(" "),s("div",{staticClass:"p-2"},[s("div",{staticClass:"input-group info"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"reference",staticClass:"outline-none rounded border-2 p-2 w-full",attrs:{type:"text",placeholder:"Order Reference"},domProps:{value:e.title},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitHold()},input:function(t){t.target.composing||(e.title=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"p-2"},[s("p",{staticClass:"text-secondary"},[e._v("\n                "+e._s(e.__("The current order will be set on hold. You can retreive this order from the pending order button. Providing a reference to it might help you to identify the order more quickly."))+"\n            ")])])]),e._v(" "),s("div",{staticClass:"flex ns-box-footer"},[s("div",{staticClass:" cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold",on:{click:function(t){return e.submitHold()}}},[e._v("\n            "+e._s(e.__("Confirm"))+"\n        ")]),e._v(" "),s("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-error-secondary text-white font-semibold",on:{click:function(t){return e.$popup.close()}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n        ")])])])}),[],!1,null,null,null).exports;var J=s(7266);const ee={name:"ns-pos-note-popup",data:function(){return{validation:new J.Z,fields:[{label:(0,a.__)("Note"),name:"note",value:"",description:(0,a.__)("More details about this order"),type:"textarea"},{label:(0,a.__)("Display On Receipt"),name:"note_visibility",value:"",options:[{label:(0,a.__)("Yes"),value:"visible"},{label:(0,a.__)("No"),value:"hidden"}],description:(0,a.__)("Will display the note on the receipt"),type:"switch"}]}},mounted:function(){var e=this;this.popupCloser(),this.fields.forEach((function(t){"note"===t.name?t.value=e.$popupParams.note:"note_visibility"===t.name&&(t.value=e.$popupParams.note_visibility)}))},methods:{__:a.__,popupResolver:o.Z,popupCloser:Y.Z,closePopup:function(){this.popupResolver(!1)},saveNote:function(){if(!this.validation.validateFields(this.fields)){var e=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,e),this.$forceUpdate(),console.log(this.fields),P.kX.error((0,a.__)("Unable to proceed the form is not valid.")).subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}};const te=(0,d.Z)(ee,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 flex justify-between items-center border-b ns-box-header"},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Order Note")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"p-2 flex justify-end border-t ns-box-footer"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveNote()}}},[e._v("Save")])],1)])}),[],!1,null,null,null).exports;const se={name:"ns-pos-tax-popup",data:function(){return{validation:new J.Z,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_groups:[],activeTab:"",group_fields:[{label:(0,a.__)("Select Tax"),name:"tax_group_id",description:(0,a.__)("Define the tax that apply to the sale."),type:"select",disabled:!0,value:"",validation:"required",options:[]},{label:(0,a.__)("Type"),name:"tax_type",disabled:!0,value:"",description:(0,a.__)("Define how the tax is computed"),type:"select",validation:"required",options:[{label:(0,a.__)("Exclusive"),value:"exclusive"},{label:(0,a.__)("Inclusive"),value:"inclusive"}]}]}},mounted:function(){var e=this;this.loadGroups(),this.popupCloser(),this.activeTab=this.$popupParams.activeTab||"settings",this.group_fields.forEach((function(t){t.value=e.$popupParams[t.name]||void 0})),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t})),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t,["variable_vat","products_variable_vat"].includes(e.options.ns_pos_vat)&&e.group_fields.forEach((function(e){return e.disabled=!1}))}))},destroyed:function(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:a.__,popupCloser:Y.Z,popupResolver:o.Z,changeActive:function(e){this.activeTab=e},closePopup:function(){this.popupResolver(!1)},saveTax:function(){if(!this.validation.validateFields(this.group_fields))return P.kX.error((0,a.__)("Unable to proceed the form is not valid.")).subscribe();var e=this.validation.extractFields(this.group_fields);this.popupResolver(e)},loadGroups:function(){var e=this;P.ih.get("/api/nexopos/v4/taxes/groups").subscribe((function(t){e.groups=t,e.group_fields.forEach((function(t){"tax_group_id"===t.name&&(t.options=e.groups.map((function(e){return{label:e.name,value:e.id}})))}))}))}}};const re=(0,d.Z)(se,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bg-white shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 flex justify-between items-center border-b border-gray-200"},[s("h3",{staticClass:"text-blog"},[e._v(e._s(e.__("Tax & Summary")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 bg-gray-50"},[s("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.changeActive(t)}}},[s("ns-tabs-item",{attrs:{padding:"0",label:e.__("Settings"),identifier:"settings",active:!0}},[s("div",{staticClass:"p-2 border-b border-gray-200"},e._l(e.group_fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"flex justify-end p-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveTax()}}},[e._v("Save")])],1)]),e._v(" "),s("ns-tabs-item",{attrs:{padding:"0",label:e.__("Summary"),identifier:"summary",active:!1}},[e.order?s("div",{staticClass:"p-2"},[e._l(e.order.taxes,(function(t){return s("div",{key:t.id,staticClass:"border-blue-200 mb-2 border bg-blue-100 shadow p-2 w-full flex justify-between items-center text-gray-700"},[s("span",[e._v(e._s(t.tax_name))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(t.tax_value)))])])})),e._v(" "),0===e.order.taxes.length?s("div",{staticClass:"p-2 text-center text-gray-600"},[e._v("No tax is active")]):e._e()],2):e._e()])],1)],1)])}),[],!1,null,null,null).exports;var ne=s(2459);const ie={name:"ns-pos-order-settings",mounted:function(){var e=this;nsHttpClient.get("/api/nexopos/v4/fields/ns.pos-order-settings").subscribe((function(t){t.forEach((function(t){t.value=e.$popupParams.order[t.name]||""})),e.fields=e.validation.createFields(t)}),(function(e){})),this.popupCloser()},data:function(){return{fields:[],validation:new J.Z}},methods:{__,popupCloser,popupResolver,closePopup:function(){this.popupResolver(!1)},saveSettings:function(){var e=this.validation.extractFields(this.fields);this.popupResolver(e)}}};const oe=(0,d.Z)(ie,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg flex flex-col ns-box w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"p-2 border-b ns-box-header items-center flex justify-between"},[s("h3",{staticClass:"text-semibold"},[e._v(e._s(e.__("Order Settings")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"p-2 flex-auto border-b ns-box-body overflow-y-auto"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1),e._v(" "),s("div",{staticClass:"p-2 flex justify-end ns-box-footer"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.saveSettings()}}},[e._v(e._s(e.__("Save")))])],1)])}),[],!1,null,null,null).exports;const ae={name:"ns-pos-product-price-product",components:{nsNumpad:k.Z},computed:{},data:function(){return{product:{}}},mounted:function(){this.popupCloser(),this.product=this.$popupParams.product},methods:{popupResolver,popupCloser,__,updateProductPrice:function(e){this.product.unit_price=e},resolveProductPrice:function(e){this.popupResolver(this.product.unit_price)}}};const ce=(0,d.Z)(ae,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[s("div",{staticClass:"popup-heading ns-box-header"},[s("h3",[e._v(e._s(e.__("Product Price")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.popupResolver(!1)}}})],1)]),e._v(" "),s("div",{staticClass:"flex flex-col ns-box-body"},[s("div",{staticClass:"h-16 flex items-center justify-center elevation-surface font-bold"},[s("h2",{staticClass:"text-2xl"},[e._v(e._s(e._f("currency")(e.product.unit_price)))])]),e._v(" "),s("div",{staticClass:"p-2"},[s("ns-numpad",{attrs:{floating:!0,value:e.product.unit_price},on:{changed:function(t){return e.updateProductPrice(t)},next:function(t){return e.resolveProductPrice(t)}}})],1)])])}),[],!1,null,null,null).exports;var le=s(2277);function ue(e,t,s,r,n,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const de={name:"ns-pos-quick-product-popup",methods:{__:a.__,popupCloser:Y.Z,popupResolver:o.Z,close:function(){this.popupResolver(!1)},addProduct:function(){var e,t=this;return(e=n().mark((function e(){var s,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.validation.validateFields(t.fields)){e.next=3;break}return e.abrupt("return",P.kX.error((0,a.__)("Unable to proceed. The form is not valid.")).subscribe());case 3:return s=t.validation.extractFields(t.fields),e.next=6,POS.defineQuantities(s,t.units);case 6:r=e.sent,s.$quantities=function(){return r},s.$original=function(){return{stock_management:"disabled",category_id:0,tax_group:t.tax_groups.filter((function(e){return parseInt(e.id)===parseInt(s.tax_group_id)}))[0],tax_group_id:s.tax_group_id,tax_type:s.tax_type}},s.unit_name=t.units.filter((function(e){return e.id===s.unit_id}))[0].name,s.quantity=parseFloat(s.quantity),POS.addToCart(s),t.close();case 13:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function o(e){ue(i,r,n,o,a,"next",e)}function a(e){ue(i,r,n,o,a,"throw",e)}o(void 0)}))})()},loadData:function(){var e=this;this.loaded=!1,(0,le.D)(nsHttpClient.get("/api/nexopos/v4/units"),nsHttpClient.get("/api/nexopos/v4/taxes/groups")).subscribe({next:function(t){e.units=t[0],e.tax_groups=t[1],e.fields.filter((function(e){"tax_group_id"===e.name&&(e.options=t[1].map((function(e){return{label:e.name,value:e.id}}))),"unit_id"===e.name&&(e.options=t[0].map((function(e){return{label:e.name,value:e.id}})))})),e.buildForm()},error:function(e){}})},buildForm:function(){this.fields=this.validation.createFields(this.fields),this.loaded=!0}},data:function(){return{units:[],tax_groups:[],loaded:!1,validation:new J.Z,fields:[{label:(0,a.__)("Name"),name:"name",type:"text",description:(0,a.__)("Provide a unique name for the product."),validation:"required"},{label:(0,a.__)("Unit Price"),name:"unit_price",type:"text",description:(0,a.__)("Define what is the sale price of the item."),validation:"required"},{label:(0,a.__)("Quantity"),name:"quantity",type:"text",value:1,description:(0,a.__)("Set the quantity of the product."),validation:"required"},{label:(0,a.__)("Unit"),name:"unit_id",type:"select",options:[],description:(0,a.__)("Assign a unit to the product."),validation:"required"},{label:(0,a.__)("Tax Type"),name:"tax_type",type:"select",options:[{label:(0,a.__)("Disabled"),value:""},{label:(0,a.__)("Inclusive"),value:"inclusive"},{label:(0,a.__)("Exclusive"),value:"exclusive"}],description:(0,a.__)("Define what is tax type of the item.")},{label:(0,a.__)("Tax Group"),name:"tax_group_id",type:"select",options:[],description:(0,a.__)("Choose the tax group that should apply to the item.")}]}},mounted:function(){this.popupCloser(),this.loadData()}};const pe=(0,d.Z)(de,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-95vw flex flex-col h-95vh shadow-lg md:w-3/5-screen lg:w-2/5-screen md:h-3/5-screen ns-box"},[s("div",{staticClass:"header ns-box-header border-b flex justify-between p-2 items-center"},[s("h3",[e._v(e._s(e.__("Product / Service")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"ns-box-body p-2 flex-auto overflow-y-auto"},[e.loaded?e._e():s("div",{staticClass:"h-full w-full flex justify-center items-center"},[s("ns-spinner")],1),e._v(" "),e.loaded?e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})):e._e()],2),e._v(" "),s("div",{staticClass:"ns-box-footer border-t flex justify-between p-2"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.addProduct()}}},[e._v(e._s(e.__("Create")))])],1)])])}),[],!1,null,null,null).exports;function fe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function _e(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(s),!0).forEach((function(t){ve(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):fe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ve(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function be(e,t,s,r,n,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}function he(e){return function(){var t=this,s=arguments;return new Promise((function(r,n){var i=e.apply(t,s);function o(e){be(i,r,n,o,a,"next",e)}function a(e){be(i,r,n,o,a,"throw",e)}o(void 0)}))}}const me={name:"ns-pos-cart",data:function(){return{popup:null,products:[],visibleSection:null,visibleSectionSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:{}}},computed:{selectedType:function(){return this.order.type?this.order.type.label:"N/A"},isVisible:function(){return"cart"===this.visibleSection},customerName:function(){return this.order.customer?this.order.customer.name:"N/A"},couponName:function(){return"Apply Coupon"}},mounted:function(){var e=this;this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),this.typeSubscribe=POS.types.subscribe((function(t){return e.types=t})),this.orderSubscribe=POS.order.subscribe((function(t){e.order=t})),this.productSubscribe=POS.products.subscribe((function(t){e.products=t,e.$forceUpdate()})),this.settingsSubscribe=POS.settings.subscribe((function(t){e.settings=t})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:a.__,switchTo:B.Z,openAddQuickProduct:function(){new Promise((function(e,t){i.G.show(pe,{resolve:e,reject:t})})).then((function(e){})).catch((function(e){}))},changeProductPrice:function(e){var t=this;return he(n().mark((function s(){var r,o;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t.settings.edit_purchase_price){s.next=2;break}return s.abrupt("return",P.kX.error((0,a.__)("You don't have the right to edit the purchase price.")).subscribe());case 2:if(!t.settings.unit_price_editable){s.next=19;break}return s.prev=3,s.next=6,new Promise((function(t,s){return i.G.show(ce,{product:Object.assign({},e),resolve:t,reject:s})}));case 6:return r=s.sent,o=_e(_e({},e.$quantities()),{custom_price_edit:r}),e.$quantities=function(){return o},e.mode="custom",e=POS.computeProductTax(e),POS.refreshProducts(POS.products.getValue()),POS.refreshCart(),s.abrupt("return",P.kX.success((0,a.__)("The product price has been updated.")).subscribe());case 16:return s.prev=16,s.t0=s.catch(3),s.abrupt("return");case 19:return s.abrupt("return",P.kX.error((0,a.__)("The editable price feature is disabled.")).subscribe());case 20:case"end":return s.stop()}}),s,null,[[3,16]])})))()},selectCoupon:function(){return he(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,t){i.G.show(ne.Z,{resolve:e,reject:t})}));case 3:e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()},defineOrderSettings:function(){var e=this;return he(n().mark((function t(){var s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.settings.edit_settings){t.next=2;break}return t.abrupt("return",P.kX.error((0,a.__)("You're not allowed to edit the order settings.")).subscribe());case 2:return t.prev=2,t.next=5,new Promise((function(t,s){i.G.show(oe,{resolve:t,reject:s,order:e.order})}));case 5:s=t.sent,POS.order.next(_e(_e({},e.order),s)),t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:case"end":return t.stop()}}),t,null,[[2,9]])})))()},openNotePopup:function(){var e=this;return he(n().mark((function t(){var s,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,s){var r=e.order.note,n=e.order.note_visibility;i.G.show(te,{resolve:t,reject:s,note:r,note_visibility:n})}));case 3:s=t.sent,r=_e(_e({},e.order),s),POS.order.next(r),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),!1!==t.t0&&P.kX.error(t.t0.message).subscribe();case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},selectTaxGroup:function(){var e=arguments,t=this;return he(n().mark((function s(){var r,o,a;return n().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"settings",s.prev=1,s.next=4,new Promise((function(e,s){var n=t.order.taxes,o=t.order.tax_group_id,a=t.order.tax_type;i.G.show(re,{resolve:e,reject:s,taxes:n,tax_group_id:o,tax_type:a,activeTab:r})}));case 4:o=s.sent,a=_e(_e({},t.order),o),POS.order.next(a),POS.refreshCart(),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(1),console.log(s.t0);case 13:case"end":return s.stop()}}),s,null,[[1,10]])})))()},openTaxSummary:function(){this.selectTaxGroup("summary")},voidOngoingOrder:function(){POS.voidOrder(this.order)},holdOrder:function(){var e=this;return he(n().mark((function t(){var s,r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("hold"!==e.order.payment_status&&e.order.payments.length>0)){t.next=2;break}return t.abrupt("return",P.kX.error("Unable to hold an order which payment status has been updated already.").subscribe());case 2:s=P.kq.applyFilters("ns-hold-queue",[R,L,U]),t.t0=n().keys(s);case 4:if((t.t1=t.t0()).done){t.next=18;break}return r=t.t1.value,t.prev=6,o=new s[r](e.order),t.next=10,o.run();case 10:t.sent,t.next=16;break;case 13:return t.prev=13,t.t2=t.catch(6),t.abrupt("return",!1);case 16:t.next=4;break;case 18:P.kq.applyFilters("ns-override-hold-popup",(function(){new Promise((function(t,s){i.G.show(K,{resolve:t,reject:s,order:e.order})})).then((function(t){e.order.title=t.title,e.order.payment_status="hold",POS.order.next(e.order);var s=i.G.show(j.default);POS.submitOrder().then((function(e){s.close(),P.kX.success(e.message).subscribe()}),(function(e){s.close(),P.kX.error(e.message).subscribe()}))}))}))();case 20:case"end":return t.stop()}}),t,null,[[6,13]])})))()},openDiscountPopup:function(e,t){return this.settings.products_discount||"product"!==t?this.settings.cart_discount||"cart"!==t?void i.G.show(p,{reference:e,type:t,onSubmit:function(s){"product"===t?POS.updateProduct(e,s):"cart"===t&&POS.updateCart(e,s)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"}):P.kX.error("You're not allowed to add a discount on the cart.").subscribe():P.kX.error("You're not allowed to add a discount on the product.").subscribe()},selectCustomer:function(){i.G.show(q.Z)},toggleMode:function(e){"normal"===e.mode?i.G.show(f.default,{title:"Enable WholeSale Price",message:"Would you like to switch to wholesale price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"wholesale"})}}):i.G.show(f.default,{title:"Enable Normal Price",message:"Would you like to switch to normal price ?",onAction:function(t){t&&POS.updateProduct(e,{mode:"normal"})}})},remove:function(e){i.G.show(f.default,{title:"Confirm Your Action",message:"Would you like to delete this product ?",onAction:function(t){t&&POS.removeProduct(e)}})},changeQuantity:function(e){new I.$(e).run({unit_quantity_id:e.unit_quantity_id,unit_name:e.unit_name,$quantities:e.$quantities}).then((function(t){POS.updateProduct(e,t)}))},payOrder:function(){var e=this;return he(n().mark((function t(){var s,r,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=P.kq.applyFilters("ns-pay-queue",[R,L,U,Q]),t.t0=n().keys(s);case 2:if((t.t1=t.t0()).done){t.next=16;break}return r=t.t1.value,t.prev=4,i=new s[r](e.order),t.next=8,i.run();case 8:t.sent,t.next=14;break;case 11:return t.prev=11,t.t2=t.catch(4),t.abrupt("return",!1);case 14:t.next=2;break;case 16:case"end":return t.stop()}}),t,null,[[4,11]])})))()},openOrderType:function(){i.G.show(G.Z)},openShippingPopup:function(){i.G.show(z.Z)}}};const ye=(0,d.Z)(me,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-auto flex flex-col ns-box",attrs:{id:"pos-cart"}},["cart"===e.visibleSection?s("div",{staticClass:"flex pl-2",attrs:{id:"tools"}},[s("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold ns-box-header",on:{click:function(t){return e.switchTo("cart")}}},[s("span",[e._v(e._s(e.__("Cart")))]),e._v(" "),e.order?s("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[e._v(e._s(e.order.products.length))]):e._e()]),e._v(" "),s("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 bg-gray-300 border-t border-r border-l border-gray-300 text-gray-600",on:{click:function(t){return e.switchTo("grid")}}},[e._v("\n            "+e._s(e.__("Products"))+"\n        ")])]):e._e(),e._v(" "),s("div",{staticClass:"rounded shadow ns-box-body flex-auto flex overflow-hidden"},[s("div",{staticClass:"cart-table flex flex-auto flex-col overflow-hidden"},[s("div",{staticClass:"w-full p-2 border-b border-box-edge",attrs:{id:"cart-toolbox"}},[s("div",{staticClass:"border border-input-edge rounded overflow-hidden"},[s("div",{staticClass:"flex flex-wrap"},[s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none",on:{click:function(t){return e.openNotePopup()}}},[s("i",{staticClass:"las la-comment"}),e._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Comments")))])])]),e._v(" "),s("hr",{staticClass:"border-input-edge h-10",staticStyle:{width:"1px"}}),e._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(t){return e.selectTaxGroup()}}},[s("i",{staticClass:"las la-balance-scale-left"}),e._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Taxes")))]),e._v(" "),e.order.taxes&&e.order.taxes.length>0?s("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-primary text-white"},[e._v(e._s(e.order.taxes.length))]):e._e()])]),e._v(" "),s("hr",{staticClass:"border-input-edge h-10",staticStyle:{width:"1px"}}),e._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(t){return e.selectCoupon()}}},[s("i",{staticClass:"las la-tags"}),e._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Coupons")))]),e._v(" "),e.order.coupons&&e.order.coupons.length>0?s("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-primary text-white"},[e._v(e._s(e.order.coupons.length))]):e._e()])]),e._v(" "),s("hr",{staticClass:"border-input-edge h-10",staticStyle:{width:"1px"}}),e._v(" "),s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(t){return e.defineOrderSettings()}}},[s("i",{staticClass:"las la-tools"}),e._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Settings")))])])]),e._v(" "),s("hr",{staticClass:"border-input-edge h-10",staticStyle:{width:"1px"}}),e._v(" "),"yes"===e.options.ns_pos_quick_product?s("div",{staticClass:"ns-button"},[s("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(t){return e.openAddQuickProduct()}}},[s("i",{staticClass:"las la-plus"}),e._v(" "),s("span",{staticClass:"ml-1 hidden md:inline-block"},[e._v(e._s(e.__("Product")))])])]):e._e(),e._v(" "),s("hr",{staticClass:"border-input-edge h-10",staticStyle:{width:"1px"}})])])]),e._v(" "),s("div",{staticClass:"w-full text-primary font-semibold flex",attrs:{id:"cart-table-header"}},[s("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-box-edge"},[e._v(e._s(e.__("Product")))]),e._v(" "),s("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0 border-box-edge"},[e._v(e._s(e.__("Quantity")))]),e._v(" "),s("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0 border-box-edge"},[e._v(e._s(e.__("Total")))])]),e._v(" "),s("div",{staticClass:"flex flex-auto flex-col overflow-auto",attrs:{id:"cart-products-table"}},[0===e.products.length?s("div",{staticClass:"text-primary flex"},[s("div",{staticClass:"w-full text-center py-4 border-b border-box-edge"},[s("h3",[e._v(e._s(e.__("No products added...")))])])]):e._e(),e._v(" "),e._l(e.products,(function(t,r){return s("div",{key:t.barcode,staticClass:"product-item flex",attrs:{"product-index":r}},[s("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0 border-box-edge"},[s("div",{staticClass:"flex justify-between product-details mb-1"},[s("h3",{staticClass:"font-semibold"},[e._v("\n                                "+e._s(t.name)+" — "+e._s(t.unit_name)+"\n                            ")]),e._v(" "),s("div",{staticClass:"-mx-1 flex product-options"},[s("div",{staticClass:"px-1"},[s("a",{staticClass:"hover:text-error-secondary cursor-pointer outline-none border-dashed py-1 border-b border-error-secondary text-sm",on:{click:function(s){return e.remove(t)}}},[s("i",{staticClass:"las la-trash text-xl"})])]),e._v(" "),s("div",{staticClass:"px-1"},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-success-secondary border-success-secondary":"border-info-primary",on:{click:function(s){return e.toggleMode(t)}}},[s("i",{staticClass:"las la-award text-xl"})])])])]),e._v(" "),s("div",{staticClass:"flex justify-between product-controls"},[s("div",{staticClass:"-mx-1 flex flex-wrap"},[s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[s("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b  text-sm",class:"wholesale"===t.mode?"text-success-secondary hover:text-success-secondary border-success-secondary":"hover:text-info-primary border-info-primary",on:{click:function(s){return e.changeProductPrice(t)}}},[e._v(e._s(e.__("Price"))+" : "+e._s(e._f("currency")(t.unit_price)))])]),e._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(s){return e.openDiscountPopup(t,"product")}}},[e._v(e._s(e.__("Discount"))+" "),"percentage"===t.discount_type?s("span",[e._v(e._s(t.discount_percentage)+"%")]):e._e(),e._v(" : "+e._s(e._f("currency")(t.discount)))])]),e._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(s){return e.changeQuantity(t)}}},[e._v(e._s(e.__("Quantity :"))+" "+e._s(t.quantity))])]),e._v(" "),s("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[s("span",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},[e._v(e._s(e.__("Total :"))+" "+e._s(e._f("currency")(t.total_price)))])])])])]),e._v(" "),s("div",{staticClass:"hidden lg:flex w-1/6 p-2 border-b border-box-edge items-center justify-center cursor-pointer ns-numpad-key",on:{click:function(s){return e.changeQuantity(t)}}},[s("span",{staticClass:"border-b border-dashed border-info-primary p-2"},[e._v(e._s(t.quantity))])]),e._v(" "),s("div",{staticClass:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 border-box-edge items-center justify-center"},[e._v(e._s(e._f("currency")(t.total_price)))])])}))],2),e._v(" "),s("div",{staticClass:"flex",attrs:{id:"cart-products-summary"}},["both"===e.visibleSection?s("table",{staticClass:"table ns-table w-full text-sm "},[s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v(e._s(e.__("Customer :"))+" "+e._s(e.customerName))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[e._v(e._s(e.__("Sub Total")))]),e._v(" "),s("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.subtotal)))])]),e._v(" "),s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v(e._s(e.__("Type :"))+" "+e._s(e.selectedType))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("span",[e._v(e._s(e.__("Discount")))]),e._v(" "),"percentage"===e.order.discount_type?s("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?s("span",[e._v("("+e._s(e.__("Flat"))+")")]):e._e()]),e._v(" "),s("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?s("tr",[s("td",{staticClass:"border p-2",attrs:{width:"200"}}),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v(e._s(e.__("Shipping")))])]),e._v(" "),s("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.shipping)))])]):e._e(),e._v(" "),s("tr",{staticClass:"bg-success-primary"},[s("td",{staticClass:"border p-2",attrs:{width:"200"}},[e.order?s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v(e._s(e.__("Tax"))+" : "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"200"}},[e._v(e._s(e.__("Total")))]),e._v(" "),s("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[e._v(e._s(e._f("currency")(e.order.total)))])])]):e._e(),e._v(" "),"cart"===e.visibleSection?s("table",{staticClass:"table w-full text-sm "},[s("tr",[s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.selectCustomer()}}},[e._v(e._s(e.__("Customer :"))+" "+e._s(e.customerName))])]),e._v(" "),s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between"},[s("span",[e._v(e._s(e.__("Sub Total")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.subtotal)))])])])]),e._v(" "),s("tr",[s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openOrderType()}}},[e._v(e._s(e.__("Type :"))+" "+e._s(e.selectedType))])]),e._v(" "),s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between items-center"},[s("p",[s("span",[e._v(e._s(e.__("Discount")))]),e._v(" "),"percentage"===e.order.discount_type?s("span",[e._v("("+e._s(e.order.discount_percentage)+"%)")]):e._e(),e._v(" "),"flat"===e.order.discount_type?s("span",[e._v("("+e._s(e.__("Flat"))+")")]):e._e()]),e._v(" "),s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[e._v(e._s(e._f("currency")(e.order.discount)))])])])]),e._v(" "),e.order.type&&"delivery"===e.order.type.identifier?s("tr",[s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}}),e._v(" "),s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openShippingPopup()}}},[e._v(e._s(e.__("Shipping")))]),e._v(" "),s("span")])]):e._e(),e._v(" "),s("tr",{staticClass:"bg-green-200"},[s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[e.order?s("a",{staticClass:"hover:text-info-primary cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(t){return e.openTaxSummary()}}},[e._v(e._s(e.__("Tax :"))+" "+e._s(e._f("currency")(e.order.tax_value)))]):e._e()]),e._v(" "),s("td",{staticClass:"border border-gray-300 p-2",attrs:{width:"200"}},[s("div",{staticClass:"flex justify-between w-full"},[s("span",[e._v(e._s(e.__("Total")))]),e._v(" "),s("span",[e._v(e._s(e._f("currency")(e.order.total)))])])])])]):e._e()]),e._v(" "),s("div",{staticClass:"h-16 flex flex-shrink-0 border-t border-box-edge",attrs:{id:"cart-bottom-buttons"}},[s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto",attrs:{id:"pay-button"},on:{click:function(t){return e.payOrder()}}},[s("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-cash-register"}),e._v(" "),s("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Pay")))])]),e._v(" "),s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto",attrs:{id:"hold-button"},on:{click:function(t){return e.holdOrder()}}},[s("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-pause"}),e._v(" "),s("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Hold")))])]),e._v(" "),s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-white border-r border-box-edge hover:bg-indigo-100 flex-auto text-gray-700",attrs:{id:"discount-button"},on:{click:function(t){return e.openDiscountPopup(e.order,"cart")}}},[s("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-percent"}),e._v(" "),s("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Discount")))])]),e._v(" "),s("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-box-edge hover:bg-red-600 flex-auto",attrs:{id:"void-button"},on:{click:function(t){return e.voidOngoingOrder(e.order)}}},[s("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-trash"}),e._v(" "),s("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[e._v(e._s(e.__("Void")))])])])])])])}),[],!1,null,null,null).exports},8935:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});var r=s(9671),n=s(9763),i=s(8603),o=s(7389);const a={name:"ns-pos-search-product",data:function(){return{searchValue:"",products:[],isLoading:!1,debounce:null}},watch:{searchValue:function(){var e=this;clearTimeout(this.debounce),this.debounce=setTimeout((function(){e.search()}),500)}},mounted:function(){this.$refs.searchField.focus(),this.popupCloser()},methods:{__:o.__,popupCloser:i.Z,addToCart:function(e){POS.addToCart(e),this.$popup.close()},search:function(){var e=this;this.isLoading=!0,r.ih.post("/api/nexopos/v4/products/search",{search:this.searchValue}).subscribe((function(t){e.isLoading=!1,e.products=t,1===e.products.length&&e.addToCart(e.products[0])}),(function(t){e.isLoading=!1,r.kX.error(t.message).subscribe()}))}}};var c=s(1900);const l=(0,c.Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-lg w-95vw h-95vh md:h-3/5-screen md:w-2/4-screen flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"text-primary"},[e._v(e._s(e.__("Search Product")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-hidden flex flex-col"},[s("div",{staticClass:"p-2 border-b ns-box-body"},[s("div",{staticClass:"flex input-group info border-2 rounded overflow-hidden"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchValue,expression:"searchValue"}],ref:"searchField",staticClass:"p-2  outline-none flex-auto text-primary",attrs:{type:"text"},domProps:{value:e.searchValue},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()},input:function(t){t.target.composing||(e.searchValue=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-2",on:{click:function(t){return e.search()}}},[e._v(e._s(e.__("Search")))])])]),e._v(" "),s("div",{staticClass:"overflow-y-auto ns-scrollbar flex-auto relative"},[s("ul",{staticClass:"ns-vertical-menu"},e._l(e.products,(function(t){return s("li",{key:t.id,staticClass:"cursor-pointer p-2 flex justify-between border-b",on:{click:function(s){return e.addToCart(t)}}},[s("div",{staticClass:"text-primary"},[e._v("\n                        "+e._s(t.name)+"\n                    ")]),e._v(" "),s("div")])})),0),e._v(" "),0===e.products.length?s("ul",[s("li",{staticClass:"text-primary text-center p-2"},[e._v(e._s(e.__("There is nothing to display. Have you started the search ?")))])]):e._e(),e._v(" "),e.isLoading?s("div",{staticClass:"absolute h-full w-full flex items-center justify-center z-10 top-0",staticStyle:{background:"rgb(187 203 214 / 29%)"}},[s("ns-spinner")],1):e._e()])])])}),[],!1,null,null,null).exports,u={name:"ns-pos-grid",data:function(){return{items:Array.from({length:1e3},(function(e,t){return{data:"#"+t}})),products:[],categories:[],breadcrumbs:[],autoFocus:!1,barcode:"",previousCategory:null,order:null,visibleSection:null,breadcrumbsSubsribe:null,orderSubscription:null,visibleSectionSubscriber:null,currentCategory:null,interval:null,searchTimeout:null,gridItemsWidth:0,gridItemsHeight:0,screenSubscriber:null,rebuildGridTimeout:null,rebuildGridComplete:!1,isLoading:!1}},computed:{hasCategories:function(){return this.categories.length>0}},watch:{barcode:function(){var e=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.submitSearch(e.barcode)}),200)}},mounted:function(){var e=this;this.loadCategories(),this.breadcrumbsSubsribe=POS.breadcrumbs.subscribe((function(t){e.breadcrumbs=t})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t})),this.screenSubscriber=POS.screen.subscribe((function(t){clearTimeout(e.rebuildGridTimeout),e.rebuildGridComplete=!1,e.rebuildGridTimeout=setTimeout((function(){e.rebuildGridComplete=!0,e.computeGridWidth()}),500)})),this.orderSubscription=POS.order.subscribe((function(t){return e.order=t})),this.interval=setInterval((function(){return e.checkFocus()}),500)},destroyed:function(){this.orderSubscription.unsubscribe(),this.breadcrumbsSubsribe.unsubscribe(),this.visibleSectionSubscriber.unsubscribe(),this.screenSubscriber.unsubscribe(),clearInterval(this.interval)},methods:{__:o.__,switchTo:n.Z,computeGridWidth:function(){null!==document.getElementById("grid-items")&&(this.gridItemsWidth=document.getElementById("grid-items").offsetWidth,this.gridItemsHeight=document.getElementById("grid-items").offsetHeight)},cellSizeAndPositionGetter:function(e,t){var s={xs:{width:this.gridItemsWidth/2,items:2,height:200},sm:{width:this.gridItemsWidth/2,items:2,height:200},md:{width:this.gridItemsWidth/3,items:3,height:150},lg:{width:this.gridItemsWidth/4,items:4,height:150},xl:{width:this.gridItemsWidth/6,items:6,height:150}},r=s[POS.responsive.screenIs].width,n=s[POS.responsive.screenIs].height;return{width:r-0,height:n,x:t%s[POS.responsive.screenIs].items*r-0,y:parseInt(t/s[POS.responsive.screenIs].items)*n}},openSearchPopup:function(){Popup.show(l)},submitSearch:function(e){var t=this;e.length>0&&r.ih.get("/api/nexopos/v4/products/search/using-barcode/".concat(e)).subscribe((function(e){t.barcode="",POS.addToCart(e.product)}),(function(e){t.barcode="",r.kX.error(e.message).subscribe()}))},checkFocus:function(){this.autoFocus&&(0===document.querySelectorAll(".is-popup").length&&this.$refs.search.focus())},loadCategories:function(e){var t=this;this.isLoading=!0,r.ih.get("/api/nexopos/v4/categories/pos/".concat(e?e.id:"")).subscribe({next:function(e){t.categories=e.categories.map((function(e){return{data:e}})),t.products=e.products.map((function(e){return{data:e}})),t.previousCategory=e.previousCategory,t.currentCategory=e.currentCategory,t.updateBreadCrumb(t.currentCategory),t.isLoading=!1},error:function(e){return t.isLoading=!1,r.kX.error((0,o.__)("An unexpected error occured.")).subscribe()}})},updateBreadCrumb:function(e){if(e){var t=this.breadcrumb.filter((function(t){return t.id===e.id}));if(t.length>0){var s=!0,r=this.breadcrumb.filter((function(e){return e.id===t[0].id&&s?(s=!1,!0):s}));this.breadcrumb=r}else this.breadcrumb.push(e)}else this.breadcrumb=[];POS.breadcrumbs.next(this.breadcrumb)},addToTheCart:function(e){POS.addToCart(e)}}};const d=(0,c.Z)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-grid"}},["grid"===e.visibleSection?s("div",{staticClass:"flex pl-2",attrs:{id:"tools"}},[s("div",{staticClass:"switch-cart flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 border-t border-r border-l",on:{click:function(t){return e.switchTo("cart")}}},[s("span",[e._v(e._s(e.__("Cart")))]),e._v(" "),e.order?s("span",{staticClass:"products-count flex items-center justify-center text-sm rounded-full h-6 w-6 ml-1"},[e._v(e._s(e.order.products.length))]):e._e()]),e._v(" "),s("div",{staticClass:"switch-grid cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold",on:{click:function(t){return e.switchTo("grid")}}},[e._v("\n            "+e._s(e.__("Products"))+"\n        ")])]):e._e(),e._v(" "),s("div",{staticClass:"rounded shadow  overflow-hidden flex-auto flex flex-col",attrs:{id:"grid-container"}},[s("div",{staticClass:"p-2 border-b ",attrs:{id:"grid-header"}},[s("div",{staticClass:"border rounded flex  overflow-hidden"},[s("button",{staticClass:"w-10 h-10 border-r  outline-none",on:{click:function(t){return e.openSearchPopup()}}},[s("i",{staticClass:"las la-search"})]),e._v(" "),s("button",{staticClass:"outline-none w-10 h-10 border-r ",class:e.autoFocus?"pos-button-clicked":"",on:{click:function(t){e.autoFocus=!e.autoFocus}}},[s("i",{staticClass:"las la-barcode"})]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.barcode,expression:"barcode"}],ref:"search",staticClass:"flex-auto outline-none px-2 ",attrs:{type:"text"},domProps:{value:e.barcode},on:{input:function(t){t.target.composing||(e.barcode=t.target.value)}}})])]),e._v(" "),s("div",{staticStyle:{height:"0px"}},[e.isLoading?s("div",{staticClass:"fade-in-entrance ns-loader"},[s("div",{staticClass:"bar"})]):e._e()]),e._v(" "),s("div",{staticClass:"p-2",attrs:{id:"grid-breadscrumb"}},[s("ul",{staticClass:"flex"},[s("li",[s("a",{staticClass:"px-3 ",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.loadCategories()}}},[e._v(e._s(e.__("Home"))+" ")]),e._v(" "),s("i",{staticClass:"las la-angle-right"})]),e._v(" "),s("li",e._l(e.breadcrumbs,(function(t){return s("a",{key:t.id,staticClass:"px-3",attrs:{href:"javascript:void(0)"},on:{click:function(s){return e.loadCategories(t)}}},[e._v(e._s(t.name)+" "),s("i",{staticClass:"las la-angle-right"})])})),0)])]),e._v(" "),s("div",{staticClass:"overflow-hidden h-full flex-col flex",attrs:{id:"grid-items"}},[e.rebuildGridComplete?e._e():s("div",{staticClass:"h-full w-full flex-col flex items-center justify-center"},[s("ns-spinner"),e._v(" "),s("span",{staticClass:"my-2"},[e._v("Rebuilding...")])],1),e._v(" "),e.rebuildGridComplete?[e.hasCategories?s("VirtualCollection",{attrs:{cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,collection:e.categories,height:e.gridItemsHeight,width:e.gridItemsWidth},scopedSlots:e._u([{key:"cell",fn:function(t){var r=t.data;return s("div",{staticClass:"w-full h-full"},[s("div",{key:r.id,staticClass:"cell-item w-full h-full cursor-pointer border flex flex-col items-center justify-center overflow-hidden",on:{click:function(t){return e.loadCategories(r)}}},[s("div",{staticClass:"h-full w-full flex items-center justify-center"},[r.preview_url?s("img",{staticClass:"object-cover h-full",attrs:{src:r.preview_url,alt:r.name}}):e._e(),e._v(" "),r.preview_url?e._e():s("i",{staticClass:"las la-image text-6xl"})]),e._v(" "),s("div",{staticClass:"h-0 w-full"},[s("div",{staticClass:"cell-item-label relative w-full flex items-center justify-center -top-10 h-20 py-2"},[s("h3",{staticClass:"text-sm font-bold py-2 text-center"},[e._v(e._s(r.name))])])])])])}}],null,!1,3907117767)}):e._e(),e._v(" "),e.hasCategories?e._e():s("VirtualCollection",{attrs:{cellSizeAndPositionGetter:e.cellSizeAndPositionGetter,collection:e.products,height:e.gridItemsHeight,width:e.gridItemsWidth},scopedSlots:e._u([{key:"cell",fn:function(t){var r=t.data;return s("div",{staticClass:"w-full h-full"},[s("div",{key:r.id,staticClass:"cell-item w-full h-full cursor-pointer border flex flex-col items-center justify-center overflow-hidden",on:{click:function(t){return e.addToTheCart(r)}}},[s("div",{staticClass:"h-full w-full flex items-center justify-center overflow-hidden"},[r.galleries&&r.galleries.filter((function(e){return 1===e.featured})).length>0?s("img",{staticClass:"object-cover h-full",attrs:{src:r.galleries.filter((function(e){return 1===e.featured}))[0].url,alt:r.name}}):e._e(),e._v(" "),r.galleries&&0!==r.galleries.filter((function(e){return 1===e.featured})).length?e._e():s("i",{staticClass:"las la-image text-6xl"})]),e._v(" "),s("div",{staticClass:"h-0 w-full"},[s("div",{staticClass:"cell-item-label relative w-full flex flex-col items-center justify-center -top-10 h-20 p-2"},[s("h3",{staticClass:"text-sm text-center w-full"},[e._v(e._s(r.name))]),e._v(" "),r.unit_quantities&&1===r.unit_quantities.length?s("span",{staticClass:"text-sm"},[e._v(e._s(e._f("currency")(r.unit_quantities[0].sale_price)))]):e._e()])])])])}}],null,!1,724140536)})]:e._e()],2)])])}),[],!1,null,null,null).exports},3261:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var r=s(5600),n=s(8935);const i={name:"ns-pos",computed:{buttons:function(){return POS.header.buttons}},mounted:function(){var e=this;this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(t){e.visibleSection=t}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe()},data:function(){return{visibleSection:null,visibleSectionSubscriber:null}},components:{NsPosCart:r.default,NsPosGrid:n.default}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full flex-auto flex flex-col",attrs:{id:"pos-container"}},[s("div",{staticClass:"flex overflow-hidden flex-shrink-0 px-2 pt-2"},[s("div",{staticClass:"-mx-2 flex overflow-x-auto pb-1"},e._l(e.buttons,(function(e,t){return s("div",{key:t,staticClass:"flex px-2 flex-shrink-0",attrs:{id:"header-buttons"}},[s(e,{tag:"component"})],1)})),0)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-hidden flex p-2"},[s("div",{staticClass:"flex flex-auto overflow-hidden -m-2"},[["both","cart"].includes(e.visibleSection)?s("div",{staticClass:"flex overflow-hidden p-2",class:"both"===e.visibleSection?"w-1/2":"w-full"},[s("ns-pos-cart")],1):e._e(),e._v(" "),["both","grid"].includes(e.visibleSection)?s("div",{staticClass:"p-2 flex overflow-hidden",class:"both"===e.visibleSection?"w-1/2":"w-full"},[s("ns-pos-grid")],1):e._e()])])])}),[],!1,null,null,null).exports},2459:(e,t,s)=>{s.d(t,{Z:()=>l});var r=s(8603),n=s(6386),i=s(9671),o=s(7389),a=s(2529);s(9624);const c={name:"ns-pos-coupons-load-popup",components:{nsNotice:s(8058).Z},data:function(){return{placeHolder:(0,o.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var e=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(t){e.order=t,e.order.coupons.length>0&&(e.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(t){e.customerCoupon=t,e.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:o.__,popupCloser:r.Z,popupResolver:n.Z,selectCustomer:function(){Popup.show(a.Z)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(e){this.order.coupons.splice(e,1),POS.refreshCart()},apply:function(){var e=this;try{var t=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return i.kX.error((0,o.__)("The coupon is out from validity date range.")).subscribe();var s=this.customerCoupon.coupon.products;if(s.length>0){var r=s.map((function(e){return e.product_id}));if(0===this.order.products.filter((function(e){return r.includes(e.product_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var n=this.customerCoupon.coupon.categories;if(n.length>0){var a=n.map((function(e){return e.category_id}));if(0===this.order.products.filter((function(e){return a.includes(e.$original().category_id)})).length)return i.kX.error((0,o.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var c={active:t.coupon.active,customer_coupon_id:t.id,minimum_cart_value:t.coupon.minimum_cart_value,maximum_cart_value:t.coupon.maximum_cart_value,name:t.coupon.name,type:t.coupon.type,value:0,limit_usage:t.coupon.limit_usage,code:t.coupon.code,discount_value:t.coupon.discount_value,categories:t.coupon.categories,products:t.coupon.products};POS.pushCoupon(c),this.activeTab="active-coupons",setTimeout((function(){e.popupResolver(c)}),500),i.kX.success((0,o.__)("The coupon has applied to the cart.")).subscribe()}catch(e){console.log(e)}},getCouponType:function(e){switch(e){case"percentage_discount":return(0,o.__)("Percentage");case"flat_discount":return(0,o.__)("Flat");default:return(0,o.__)("Unknown Type")}},getDiscountValue:function(e){switch(e.type){case"percentage_discount":return e.discount_value+"%";case"flat_discount":return this.$options.filters.currency(e.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(e){this.activeTab=e},getCoupon:function(e){return!this.order.customer_id>0?i.kX.error((0,o.__)("You must select a customer before applying a coupon.")).subscribe():i.ih.post("/api/nexopos/v4/customers/coupons/".concat(e),{customer_id:this.order.customer_id})},loadCoupon:function(){var e=this,t=this.couponCode;this.getCoupon(t).subscribe({next:function(t){e.customerCoupon=t,i.kX.success((0,o.__)("The coupon has been loaded.")).subscribe()},error:function(e){i.kX.error(e.message||(0,o.__)("An unexpected error occured.")).subscribe()}})}}};const l=(0,s(1900).Z)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/6-screen lg:w-2/6-screen"},[s("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Load Coupon")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"p-1 ns-box-body"},[s("ns-tabs",{attrs:{active:e.activeTab},on:{changeTab:function(t){return e.setActiveTab(t)}}},[s("ns-tabs-item",{attrs:{label:e.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[s("div",{staticClass:"border-2 input-group info rounded flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full text-primary p-2 outline-none",attrs:{type:"text",placeholder:e.placeHolder},domProps:{value:e.couponCode},on:{input:function(t){t.target.composing||(e.couponCode=t.target.value)}}}),e._v(" "),s("button",{staticClass:"px-3 py-2",on:{click:function(t){return e.loadCoupon()}}},[e._v(e._s(e.__("Load")))])]),e._v(" "),s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"info"},scopedSlots:e._u([{key:"description",fn:function(){return[e._v(e._s(e.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))]},proxy:!0}])})],1),e._v(" "),e.order&&void 0===e.order.customer_id?s("div",{staticClass:"pt-2 flex"},[s("button",{staticClass:"w-full border p-2 outline-none ns-numpad-key info cursor-pointer text-center",on:{click:function(t){return e.selectCustomer()}}},[e._v(e._s(e.__("Click here to choose a customer.")))])]):e._e(),e._v(" "),e.order&&void 0!==e.order.customer_id?s("div",{staticClass:"pt-2"},[s("ns-notice",{attrs:{color:"success"},scopedSlots:e._u([{key:"description",fn:function(){return[e._v(e._s(e.__("Loading Coupon For : ")+e.order.customer.name+" "+e.order.customer.surname))]},proxy:!0}],null,!1,2531213351)})],1):e._e(),e._v(" "),s("div",{staticClass:"overflow-hidden"},[e.customerCoupon?s("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto ns-scrollbar h-64"},[s("table",{staticClass:"w-full ns-table"},[s("tbody",[s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Coupon Name")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.name))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Discount"))+" ("+e._s(e.getCouponType(e.customerCoupon.coupon.type))+")")]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.getDiscountValue(e.customerCoupon.coupon)))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Usage")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.usage+"/"+(e.customerCoupon.limit_usage||e.__("Unlimited"))))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Valid From")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_start))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Valid Till")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.customerCoupon.coupon.valid_hours_end))])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Categories")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",e._l(e.customerCoupon.coupon.categories,(function(t){return s("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border"},[e._v(e._s(t.category.name))])})),0)])]),e._v(" "),s("tr",[s("td",{staticClass:"p-2 w-1/2 border"},[e._v(e._s(e.__("Products")))]),e._v(" "),s("td",{staticClass:"p-2 w-1/2 border"},[s("ul",e._l(e.customerCoupon.coupon.products,(function(t){return s("li",{key:t.id,staticClass:"rounded-full px-3 py-1 border"},[e._v(e._s(t.product.name))])})),0)])])])])]):e._e()])]),e._v(" "),s("ns-tabs-item",{attrs:{label:e.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[e.order?s("ul",[e._l(e.order.coupons,(function(t,r){return s("li",{key:r,staticClass:"flex justify-between elevation-surface border items-center px-2 py-1"},[s("div",{staticClass:"flex-auto"},[s("h3",{staticClass:"font-semibold text-primary p-2 flex justify-between"},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("span",[e._v(e._s(e.getDiscountValue(t)))])])]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.removeCoupon(r)}}})],1)])})),e._v(" "),0===e.order.coupons.length?s("li",{staticClass:"flex justify-between elevation-surface border items-center p-2"},[e._v("\n                        "+e._s(e.__("No coupons applies to the cart."))+"\n                    ")]):e._e()],2):e._e()])],1)],1),e._v(" "),e.customerCoupon?s("div",{staticClass:"flex"},[s("button",{staticClass:"w-1/2 px-3 py-2 bg-success-primary text-white font-bold",on:{click:function(t){return e.apply()}}},[e._v("\n            "+e._s(e.__("Apply"))+"\n        ")]),e._v(" "),s("button",{staticClass:"w-1/2 px-3 py-2 bg-error-primary text-white font-bold",on:{click:function(t){return e.cancel()}}},[e._v("\n            "+e._s(e.__("Cancel"))+"\n        ")])]):e._e()])}),[],!1,null,null,null).exports},2529:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(9671),n=s(6386),i=s(2242),o=s(16);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(e){var t=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){t.searchCustomer(e)}),500)}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(t){e.order=t})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:s(7389).__,resolveIfQueued:n.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);r.kX.info("Too many result.").subscribe()},openCustomerHistory:function(e,t){t.stopImmediatePropagation(),this.$popup.close(),i.G.show(o.Z,{customer:e,activeTab:"account-payment"})},selectCustomer:function(e){var t=this;this.customers.forEach((function(e){return e.selected=!1})),e.selected=!0,this.isLoading=!0,POS.selectCustomer(e).then((function(s){t.isLoading=!1,t.resolveIfQueued(e)})).catch((function(e){t.isLoading=!1}))},searchCustomer:function(e){var t=this;r.ih.post("/api/nexopos/v4/customers/search",{search:e}).subscribe((function(e){e.forEach((function(e){return e.selected=!1})),t.customers=e}))},createCustomerWithMatch:function(e){this.resolveIfQueued(!1),i.G.show(o.Z,{name:e})},getRecentCustomers:function(){var e=this;this.isLoading=!0,r.ih.get("/api/nexopos/v4/customers").subscribe((function(t){e.isLoading=!1,t.forEach((function(e){return e.selected=!1})),e.customers=t}),(function(t){e.isLoading=!1}))}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108"},[s("div",{staticClass:"border-b ns-box-header text-center font-semibold text-2xl py-2",attrs:{id:"header"}},[s("h2",[e._v(e._s(e.__("Select Customer")))])]),e._v(" "),s("div",{staticClass:"relative"},[s("div",{staticClass:"p-2 border-b ns-box-body items-center flex justify-between"},[s("span",[e._v(e._s(e.__("Selected"))+" : ")]),e._v(" "),s("div",{staticClass:"flex items-center justify-between"},[s("span",[e._v(e._s(e.order.customer?e.order.customer.name:"N/A"))]),e._v(" "),e.order.customer?s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button hover:border-transparent",on:{click:function(t){return e.openCustomerHistory(e.order.customer,t)}}},[s("i",{staticClass:"las la-eye"})]):e._e()])]),e._v(" "),s("div",{staticClass:"p-2 border-b ns-box-body flex justify-between text-primary"},[s("div",{staticClass:"input-group flex-auto border-2 rounded p-2"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"outline-none w-full",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:e.searchCustomerValue},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.attemptToChoose()},input:function(t){t.target.composing||(e.searchCustomerValue=t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto ns-scrollbar"},[s("ul",{staticClass:"ns-vertical-menu"},[e.customers&&0===e.customers.length?s("li",{staticClass:"p-2 text-center text-primary"},[e._v("\n                    "+e._s(e.__("No customer match your query..."))+"\n                ")]):e._e(),e._v(" "),e.customers&&0===e.customers.length?s("li",{staticClass:"p-2 cursor-pointer text-center text-primary",on:{click:function(t){return e.createCustomerWithMatch(e.searchCustomerValue)}}},[s("span",{staticClass:"border-b border-dashed border-info-primary"},[e._v(e._s(e.__("Create a customer")))])]):e._e(),e._v(" "),e._l(e.customers,(function(t){return s("li",{key:t.id,staticClass:"cursor-pointer p-2 border-b text-primary flex justify-between items-center",on:{click:function(s){return e.selectCustomer(t)}}},[s("span",[e._v(e._s(t.name))]),e._v(" "),s("p",{staticClass:"flex items-center"},[t.owe_amount>0?s("span",{staticClass:"text-error-primary"},[e._v("-"+e._s(e._f("currency")(t.owe_amount)))]):e._e(),e._v(" "),t.owe_amount>0?s("span",[e._v("/")]):e._e(),e._v(" "),s("span",{staticClass:"text-success-primary"},[e._v(e._s(e._f("currency")(t.purchases_amount)))]),e._v(" "),s("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button info",on:{click:function(s){return e.openCustomerHistory(t,s)}}},[s("i",{staticClass:"las la-eye"})])])])}))],2)]),e._v(" "),e.isLoading?s("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[s("ns-spinner",{attrs:{size:"24",border:"8"}})],1):e._e()])])}),[],!1,null,null,null).exports},16:(e,t,s)=>{s.d(t,{Z:()=>b});var r=s(8603),n=s(9671),i=s(2242),o=s(2529),a=s(7266),c=s(7389);const l={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new a.Z}},methods:{__:c.__,closeWithOverlayClicked:r.Z,proceed:function(){var e=this,t=this.$popupParams.customer,s=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,n.ih.post("/api/nexopos/v4/customers/".concat(t.id,"/account-history"),s).subscribe({next:function(t){e.isSubmiting=!1,n.kX.success(t.message).subscribe(),e.$popupParams.resolve(t),e.$popup.close()},error:function(t){e.isSubmiting=!1,n.kX.error(t.message).subscribe(),e.$popupParams.reject(t)}})},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var e=this;n.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe({next:function(t){e.fields=e.formValidation.createFields(t)}})}}};var u=s(1900);const d=(0,u.Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg ns-box flex flex-col relative"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h2",{staticClass:"font-semibold"},[e._v(e._s(e.__("New Transaction")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[0===e.fields.length?s("div",{staticClass:"h-full w-full flex items-center justify-center"},[s("ns-spinner")],1):e._e(),e._v(" "),e.fields.length>0?s("div",{staticClass:"p-2"},e._l(e.fields,(function(e,t){return s("ns-field",{key:t,attrs:{field:e}})})),1):e._e()]),e._v(" "),s("div",{staticClass:"p-2 ns-box-footer justify-between border-t flex"},[s("div"),e._v(" "),s("div",{staticClass:"px-1"},[s("div",{staticClass:"-mx-2 flex flex-wrap"},[s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"error"},on:{click:function(t){return e.close()}}},[e._v(e._s(e.__("Close")))])],1),e._v(" "),s("div",{staticClass:"px-1"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.proceed()}}},[e._v(e._s(e.__("Proceed")))])],1)])])]),e._v(" "),0===e.isSubmiting?s("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[s("ns-spinner")],1):e._e()])}),[],!1,null,null,null).exports;var p=s(2459),f=s(4864),_=s(6386);const v={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,coupons:[],rewardsResponse:[],order:null}},components:{nsPaginate:s(5834).Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var e=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(t){e.options=t})),this.subscription=POS.order.subscribe((function(t){e.order=t,void 0!==e.$popupParams.customer?(e.activeTab="account-payment",e.customer=e.$popupParams.customer,e.loadCustomerOrders(e.customer.id)):void 0!==t.customer&&(e.activeTab="account-payment",e.customer=t.customer,e.loadCustomerOrders(e.customer.id))})),this.popupCloser()},methods:{__:c.__,popupResolver:_.Z,popupCloser:r.Z,getType:function(e){switch(e){case"percentage_discount":return(0,c.__)("Percentage Discount");case"flat_discount":return(0,c.__)("Flat Discount")}},closeWithOverlayClicked:r.Z,doChangeTab:function(e){this.selectedTab=e,"coupons"===e&&this.loadCoupons(),"rewards"===e&&this.loadRewards()},loadCoupons:function(){var e=this;this.isLoadingCoupons=!0,n.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(t){e.coupons=t,e.isLoadingCoupons=!1},error:function(t){e.isLoadingCoupons=!1}})},loadRewards:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,n.ih.get(t).subscribe({next:function(t){e.rewardsResponse=t,e.isLoadingRewards=!1},error:function(t){e.isLoadingRewards=!1}})},allowedForPayment:function(e){return["unpaid","partially_paid","hold"].includes(e.payment_status)},prefillForm:function(e){void 0!==this.$popupParams.name&&(e.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),i.G.show(o.Z)},loadCustomerOrders:function(e){var t=this;n.ih.get("/api/nexopos/v4/customers/".concat(e,"/orders")).subscribe((function(e){t.orders=e}))},newTransaction:function(e){new Promise((function(t,s){i.G.show(d,{customer:e,resolve:t,reject:s})})).then((function(t){POS.loadCustomer(e.id).subscribe((function(e){POS.selectCustomer(e)}))}))},applyCoupon:function(e){var t=this;void 0===this.order.customer?i.G.show(f.default,{title:(0,c.__)("Use Customer ?"),message:(0,c.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(s){s&&POS.selectCustomer(t.customer).then((function(s){t.proceedApplyingCoupon(e)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(e):this.order.customer.id!==this.customer.id&&i.G.show(f.default,{title:(0,c.__)("Change Customer ?"),message:(0,c.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(s){s&&POS.selectCustomer(t.customer).then((function(s){t.proceedApplyingCoupon(e)}))}})},proceedApplyingCoupon:function(e){var t=this;new Promise((function(t,s){i.G.show(p.Z,{apply_coupon:e.code,resolve:t,reject:s})})).then((function(e){t.popupResolver(!1)})).catch((function(e){}))},handleSavedCustomer:function(e){n.kX.success(e.message).subscribe(),POS.selectCustomer(e.entry),this.$popup.close()}}};const b=(0,u.Z)(v,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-lg rounded w-95vw h-95vh lg:w-3/5-screen flex flex-col overflow-hidden",attrs:{id:"ns-pos-customers"}},[s("div",{staticClass:"ns-header p-2 flex justify-between items-center border-b"},[s("h3",{staticClass:"font-semibold"},[e._v(e._s(e.__("Customers")))]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.$popup.close()}}})],1)]),e._v(" "),s("div",{staticClass:"ns-body flex-auto flex p-2 overflow-y-auto"},[s("ns-tabs",{attrs:{active:e.activeTab},on:{active:function(t){e.activeTab=t}}},[s("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===e.options.ns_pos_customers_creation_enabled?s("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(t){return e.prefillForm(t)},save:function(t){return e.handleSavedCustomer(t)}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[e._v(e._s(e.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):e._e(),e._v(" "),"yes"!==e.options.ns_pos_customers_creation_enabled?s("div",{staticClass:"h-full flex-col w-full flex items-center justify-center text-primary"},[s("i",{staticClass:"lar la-hand-paper ns-icon text-6xl"}),e._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[e._v(e._s(e.__("Not Authorized")))]),e._v(" "),s("p",[e._v(e._s(e.__("Creating customers has been explicitly disabled from the settings.")))])]):e._e()],1),e._v(" "),s("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:e.__("Customer Account")}},[null===e.customer?s("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[s("i",{staticClass:"lar la-frown text-6xl"}),e._v(" "),s("h3",{staticClass:"font-medium text-2xl"},[e._v(e._s(e.__("No Customer Selected")))]),e._v(" "),s("p",[e._v(e._s(e.__("In order to see a customer account, you need to select one customer.")))]),e._v(" "),s("div",{staticClass:"my-2"},[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.openCustomerSelection()}}},[e._v(e._s(e.__("Select Customer")))])],1)]):e._e(),e._v(" "),e.customer?s("div",{staticClass:"flex flex-col flex-auto"},[s("div",{staticClass:"flex-auto p-2 flex flex-col"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},[s("div",{staticClass:"px-4 mb-4 w-full"},[s("h2",{staticClass:"font-semibold"},[e._v(e._s(e.__("Summary For"))+" : "+e._s(e.customer.name))])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-success-primary to-green-700 p-2 flex flex-col text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Purchases")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"font-bold"},[e._v(e._s(e._f("currency")(e.customer.purchases_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-error-secondary to-red-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Total Owed")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.owed_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-blue-500 to-blue-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Account Amount")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.account_amount)))])])])]),e._v(" "),s("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[s("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-teal-500 to-teal-700 p-2 text-white"},[s("h3",{staticClass:"font-medium text-lg"},[e._v(e._s(e.__("Credit Limit")))]),e._v(" "),s("div",{staticClass:"w-full flex justify-end"},[s("h2",{staticClass:"text-2xl font-bold"},[e._v(e._s(e._f("currency")(e.customer.credit_limit_amount)))])])])])]),e._v(" "),s("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[s("ns-tabs",{attrs:{active:e.selectedTab},on:{changeTab:function(t){return e.doChangeTab(t)}}},[s("ns-tabs-item",{attrs:{identifier:"orders",label:e.__("Orders")}},[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Last Purchases")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Order")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Total")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Status")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"50"}},[e._v(e._s(e.__("Options")))])])]),e._v(" "),s("tbody",{staticClass:"text-primary"},[0===e.orders.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No orders...")))])]):e._e(),e._v(" "),e._l(e.orders,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2 text-center"},[e._v(e._s(t.code))]),e._v(" "),s("td",{staticClass:"border p-2 text-center"},[e._v(e._s(e._f("currency")(t.total)))]),e._v(" "),s("td",{staticClass:"border p-2 text-right"},[e._v(e._s(t.human_status))]),e._v(" "),s("td",{staticClass:"border p-2 text-center"},[e.allowedForPayment(t)?s("button",{staticClass:"hover:bg-info-primary hover:border-transparent hover:text-white rounded-full h-8 px-2 flex items-center justify-center border border-gray ns-inset-button"},[s("i",{staticClass:"las la-wallet"}),e._v(" "),s("span",{staticClass:"ml-1"},[e._v(e._s(e.__("Payment")))])]):e._e()])])}))],2)])])])]),e._v(" "),s("ns-tabs-item",{attrs:{identifier:"coupons",label:e.__("Coupons")}},[e.isLoadingCoupons?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingCoupons?e._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Coupons")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Type")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"})])]),e._v(" "),s("tbody",{staticClass:"text-primary text-sm"},[0===e.coupons.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No coupons for the selected customer...")))])]):e._e(),e._v(" "),e._l(e.coupons,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",[e._v(e._s(t.name))]),e._v(" "),s("div",{},[s("ul",{staticClass:"-mx-2 flex"},[s("li",{staticClass:"text-xs text-primary px-2"},[e._v(e._s(e.__("Usage :"))+" "+e._s(t.usage)+"/"+e._s(t.limit_usage))]),e._v(" "),s("li",{staticClass:"text-xs text-primary px-2"},[e._v(e._s(e.__("Code :"))+" "+e._s(t.code))])])])]),e._v(" "),s("td",{staticClass:"border p-2 text-center"},[e._v(e._s(e.getType(t.coupon.type))+" \n                                                                "),"percentage_discount"===t.coupon.type?s("span",[e._v("\n                                                                    ("+e._s(t.coupon.discount_value)+"%)\n                                                                ")]):e._e(),e._v(" "),"flat_discount"===t.coupon.type?s("span",[e._v("\n                                                                    ("+e._s(e._f("currency")(t.coupon.discount_value))+")\n                                                                ")]):e._e()]),e._v(" "),s("td",{staticClass:"border p-2 text-right"},[s("ns-button",{attrs:{type:"info"},on:{click:function(s){return e.applyCoupon(t)}}},[e._v(e._s(e.__("Use Coupon")))])],1)])}))],2)])])])]],2),e._v(" "),s("ns-tabs-item",{attrs:{identifier:"rewards",label:e.__("Rewards")}},[e.isLoadingRewards?s("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[s("ns-spinner",{attrs:{size:"36"}})],1):e._e(),e._v(" "),e.isLoadingRewards?e._e():[s("div",{staticClass:"py-2 w-full"},[s("h2",{staticClass:"font-semibold text-primary"},[e._v(e._s(e.__("Rewards")))])]),e._v(" "),s("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[s("div",{staticClass:"flex-auto overflow-y-auto"},[s("table",{staticClass:"table ns-table w-full"},[s("thead",[s("tr",{staticClass:"text-primary"},[s("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[e._v(e._s(e.__("Name")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Points")))]),e._v(" "),s("th",{staticClass:"p-2 border font-semibold"},[e._v(e._s(e.__("Target")))])])]),e._v(" "),e.rewardsResponse.data?s("tbody",{staticClass:"text-primary text-sm"},[0===e.rewardsResponse.data.length?s("tr",[s("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[e._v(e._s(e.__("No rewards available the selected customer...")))])]):e._e(),e._v(" "),e._l(e.rewardsResponse.data,(function(t){return s("tr",{key:t.id},[s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.reward_name))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.points))])]),e._v(" "),s("td",{staticClass:"border p-2",attrs:{width:"300"}},[s("h3",{staticClass:"text-center"},[e._v(e._s(t.target))])])])}))],2):e._e()])])]),e._v(" "),s("div",{staticClass:"py-1 flex justify-end"},[s("ns-paginate",{attrs:{pagination:e.rewardsResponse},on:{load:function(t){return e.loadRewards(t)}}})],1)]],2)],1)],1)]),e._v(" "),s("div",{staticClass:"p-2 border-t border-box-edge flex justify-between"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.newTransaction(e.customer)}}},[e._v(e._s(e.__("Account Transaction")))])],1)])]):e._e()])],1)],1)])}),[],!1,null,null,null).exports},2004:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});const r={name:"ns-pos-loading-popup"};const n=(0,s(1900).Z)(r,(function(){var e=this.$createElement;return(this._self._c||e)("ns-spinner")}),[],!1,null,null,null).exports},8680:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(7757),n=s.n(r),i=s(6386);function o(e,t,s,r,n,i,o){try{var a=e[i](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(r,n)}const a={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(t){e.types=t,1===Object.values(e.types).length&&e.select(Object.keys(e.types)[0])}))},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:s(7389).__,resolveIfQueued:i.Z,select:function(e){var t,s=this;return(t=n().mark((function t(){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.values(s.types).forEach((function(e){return e.selected=!1})),s.types[e].selected=!0,r=s.types[e],t.prev=3,t.next=6,POS.triggerOrderTypeSelection(r);case 6:t.sent,POS.types.next(s.types),s.resolveIfQueued(r),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(3);case 13:case"end":return t.stop()}}),t,null,[[3,11]])})),function(){var e=this,s=arguments;return new Promise((function(r,n){var i=t.apply(e,s);function a(e){o(i,r,n,a,c,"next",e)}function c(e){o(i,r,n,a,c,"throw",e)}a(void 0)}))})()}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen shadow-lg",attrs:{id:"ns-order-type"}},[s("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[s("h3",{staticClass:"font-bold"},[e._v(e._s(e.__("Define The Order Type")))])]),e._v(" "),0===Object.values(e.types).length?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-1 grid-rows-1"},[s("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[s("i",{staticClass:"las la-frown text-7xl"}),e._v(" "),s("div",{staticClass:"p-4 md:w-2/3"},[s("p",{staticClass:"text-center "},[e._v(e._s(e.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),e._v(" "),s("div",{staticClass:"flex justify-center py-1"},[s("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[e._v(e._s(e.__("Read More")))])],1)])])]):e._e(),e._v(" "),Object.values(e.types).length>0?s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-2 grid-rows-2"},e._l(e.types,(function(t){return s("div",{key:t.identifier,staticClass:"ns-numpad-key info h-56 flex items-center justify-center flex-col cursor-pointer border",class:t.selected?"active":"",on:{click:function(s){return e.select(t.identifier)}}},[s("img",{staticClass:"w-32 h-32",attrs:{src:t.icon,alt:""}}),e._v(" "),s("h4",{staticClass:"font-semibold text-xl my-2"},[e._v(e._s(t.label))])])})),0):e._e()])}),[],!1,null,null,null).exports},567:(e,t,s)=>{s.d(t,{Z:()=>c});var r=s(9671),n=s(7389);function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=new Array(t);s<t;s++)r[s]=e[s];return r}const a={data:function(){return{finalValue:1,virtualStock:null,allSelected:!0,isLoading:!1,keys:[].concat(i([1,2,3].map((function(e){return{identifier:e,value:e}}))),i([4,5,6].map((function(e){return{identifier:e,value:e}}))),i([7,8,9].map((function(e){return{identifier:e,value:e}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&(e.$popupParams.reject(!1),e.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),document.addEventListener("keyup",this.handleKeyPress)},destroyed:function(){document.removeEventListener("keypress",this.handleKeyPress)},methods:{__:n.__,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},handleKeyPress:function(e){13===e.keyCode&&this.inputValue({identifier:"next"})},inputValue:function(e){if("next"===e.identifier){var t=this.$popupParams,s=t.product,i=t.data,o=parseFloat(this.finalValue);if(0===o)return r.kX.error((0,n.__)("Please provide a quantity")).subscribe();if("enabled"===s.$original().stock_management){var a=POS.getStockUsage(s.$original().id,i.unit_quantity_id)-(s.quantity||0);if(o>parseFloat(i.$quantities().quantity)-a)return r.kX.error((0,n.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",i.$quantities().quantity-a)).subscribe()}this.resolve({quantity:o})}else"backspace"===e.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=e.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+e.value,this.finalValue=parseFloat(this.finalValue))},resolve:function(e){this.$popupParams.resolve(e),this.$popup.close()}}};const c=(0,s(1900).Z)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[e.isLoading?s("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[s("ns-spinner")],1):e._e(),e._v(" "),s("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[s("div",[s("h1",{staticClass:"text-xl font-bold text-primary text-center"},[e._v(e._s(e.__("Define Quantity")))])]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.closePopup()}}})],1)]),e._v(" "),s("div",{staticClass:"h-16 border-b primary ns-box-body flex items-center justify-center",attrs:{id:"screen"}},[s("h1",{staticClass:"font-bold text-3xl"},[e._v(e._s(e.finalValue))])]),e._v(" "),s("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},e._l(e.keys,(function(t,r){return s("div",{key:r,staticClass:"ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer",on:{click:function(s){return e.inputValue(t)}}},[void 0!==t.value?s("span",[e._v(e._s(t.value))]):e._e(),e._v(" "),t.icon?s("i",{staticClass:"las",class:t.icon}):e._e()])})),0)])}),[],!1,null,null,null).exports},9702:(e,t,s)=>{s.d(t,{Z:()=>u});var r=s(9671),n=s(6386),i=s(7266);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const l={name:"ns-pos-shipping-popup",computed:{activeTabFields:function(){if(null!==this.tabs)for(var e in this.tabs)if(this.tabs[e].active)return this.tabs[e].fields;return[]},useBillingInfo:function(){return null!==this.tabs?this.tabs.billing.fields[0].value:new Object},useShippingInfo:function(){return null!==this.tabs?this.tabs.shipping.fields[0].value:new Object}},destroyed:function(){this.orderSubscription.unsubscribe()},mounted:function(){var e=this;this.$popup.event.subscribe((function(t){"click-overlay"===t.event&&e.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(t){return e.order=t})),this.loadForm()},data:function(){return{tabs:null,orderSubscription:null,order:null,formValidation:new i.Z}},watch:{useBillingInfo:function(e){var t=this;1===e&&this.tabs.billing.fields.forEach((function(e){"_use_customer_billing"!==e.name&&(e.value=t.order.customer.billing?t.order.customer.billing[e.name]:e.value)}))},useShippingInfo:function(e){var t=this;1===e&&this.tabs.shipping.fields.forEach((function(e){"_use_customer_shipping"!==e.name&&(e.value=t.order.customer.shipping?t.order.customer.shipping[e.name]:e.value)}))}},methods:{__,resolveIfQueued:n.Z,submitInformations:function(){var e=this.formValidation.extractForm({tabs:this.tabs});for(var t in e.general)["shipping","shipping_rate"].includes(t)&&(e.general[t]=parseFloat(e.general[t]));this.order=a(a({},this.order),e.general),delete e.general,delete e.shipping._use_customer_shipping,delete e.billing._use_customer_billing,this.order.addresses=e,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup:function(){this.resolveIfQueued(!1)},toggle:function(e){for(var t in this.tabs)this.tabs[t].active=!1;this.tabs[e].active=!0},loadForm:function(){var e=this;r.ih.get("/api/nexopos/v4/forms/ns.pos-addresses").subscribe((function(t){var s=t.tabs,r=function(t){"general"===t?s[t].fields.forEach((function(t){t.value=e.order[t.name]||""})):s[t].fields.forEach((function(s){s.value=e.order.addresses[t]?e.order.addresses[t][s.name]:""}))};for(var n in s)r(n);e.tabs=e.formValidation.initializeTabs(s)}))}}};const u=(0,s(1900).Z)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},[s("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[s("h3",{staticClass:"font-bold text-primary"},[e._v(e._s(e.__("Shipping & Billing")))]),e._v(" "),s("div",{staticClass:"tools"},[s("button",{staticClass:"ns-close-button rounded-full h-8 w-8 border items-center justify-center",on:{click:function(t){return e.closePopup()}}},[s("i",{staticClass:"las la-times"})])])]),e._v(" "),s("div",{staticClass:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},[s("div",{attrs:{id:"tabs-container"}},[s("div",{staticClass:"header flex",staticStyle:{"margin-bottom":"-1px"}},e._l(e.tabs,(function(t,r){return s("div",{key:r,staticClass:"tab rounded-tl rounded-tr border tab  px-3 py-2 text-primary cursor-pointer",class:t.active?"border-b-0 active":"inactive",staticStyle:{"margin-right":"-1px"},on:{click:function(t){return e.toggle(r)}}},[e._v(e._s(t.label))])})),0),e._v(" "),s("div",{staticClass:"border ns-tab-item"},[s("div",{staticClass:"px-4"},[s("div",{staticClass:"-mx-4 flex flex-wrap"},e._l(e.activeTabFields,(function(t,r){return s("div",{key:r,class:"p-4 w-full md:w-1/2 lg:w-1/3"},[s("ns-field",{attrs:{field:t},on:{blur:function(s){return e.formValidation.checkField(t)},change:function(s){return e.formValidation.checkField(t)}}})],1)})),0)])])])]),e._v(" "),s("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.submitInformations()}}},[e._v(e._s(e.__("Save")))])],1)])])}),[],!1,null,null,null).exports},3472:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(8603),n=s(7389);const i={data:function(){return{value:[],options:[],label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.type=this.$popupParams.type||this.type},methods:{popupCloser:r.Z,__:n.__,toggle:function(e){var t=this.value.indexOf(e);-1===t?this.value.unshift(e):this.value.splice(t,1)},isSelected:function(e){return this.value.indexOf(e)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(e){void 0!==e&&(this.value=[e]),this.$popupParams.resolve(this.value),this.close()}}};const o=(0,s(1900).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow-xl ns-box w-6/7-screen md:w-4/7-screen lg:w-3/7-screen overflow-hidden"},[s("div",{staticClass:"p-2 flex justify-between border-b items-center ns-box-header"},[s("span",{staticClass:"text-semibold text-primary"},[e._v("\n            "+e._s(e.label)+"\n        ")]),e._v(" "),s("div",[s("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),s("div",{staticClass:"flex-auto overflow-y-auto"},[s("ul",{staticClass:"ns-vertical-menu"},["select"===e.type?e._l(e.options,(function(t){return s("li",{key:t.value,staticClass:"p-2 border-b border-box-edge text-primary cursor-pointer",on:{click:function(s){return e.select(t)}}},[e._v(e._s(t.label))])})):e._e(),e._v(" "),"multiselect"===e.type?e._l(e.options,(function(t){return s("li",{key:t.value,staticClass:"p-2 border-b text-primary cursor-pointer",class:e.isSelected(t)?"active":"",on:{click:function(s){return e.toggle(t)}}},[e._v(e._s(t.label))])})):e._e()],2)]),e._v(" "),"multiselect"===e.type?s("div",{staticClass:"flex justify-between"},[s("div"),e._v(" "),s("div",[s("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.select()}}},[e._v(e._s(e.__("Select")))])],1)]):e._e()])}),[],!1,null,null,null).exports}}]);