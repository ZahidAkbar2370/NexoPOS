"use strict";(self.webpackChunknexopos_4x=self.webpackChunknexopos_4x||[]).push([[348],{6348:(e,t,o)=>{o.r(t),o.d(t,{default:()=>h});var n=o(7757),r=o.n(n),s=(o(381),o(1544)),i=o(9671),a=o(2744),l=o(7389),u=o(7266),c=o(3472),p=o(3506);function v(e,t,o,n,r,s,i){try{var a=e[s](i),l=a.value}catch(e){return void o(e)}a.done?t(l):Promise.resolve(l).then(n,r)}const f={name:"ns-low-stock-report",mounted:function(){this.reportType=this.options[0].value,this.loadRelevantReport()},components:{nsDatepicker:s.Z,nsDateTimePicker:a.Z,nsPaginate:p.Z},data:function(){return{products:[],options:[{label:(0,l.__)("Stock Report"),value:"stock_report"},{label:(0,l.__)("Low Stock Report"),value:"low_stock"}],stockReportResult:{},reportType:"",reportTypeName:"",validation:new u.Z}},watch:{reportType:function(){var e=this,t=this.options.filter((function(t){return t.value===e.reportType}));t.length>0?this.reportTypeName=t[0].label:this.reportTypeName=(0,l.__)("N/A")}},methods:{__:l.__,selectReport:function(){var e,t=this;return(e=r().mark((function e(){var o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,o){Popup.show(c.Z,{label:(0,l.__)("Report Type"),options:t.options,resolve:e,reject:o})}));case 3:o=e.sent,t.reportType=o[0].value,t.loadRelevantReport(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})),function(){var t=this,o=arguments;return new Promise((function(n,r){var s=e.apply(t,o);function i(e){v(s,n,r,i,a,"next",e)}function a(e){v(s,n,r,i,a,"throw",e)}i(void 0)}))})()},loadRelevantReport:function(){switch(this.reportType){case"stock_report":this.loadStockReport();break;case"low_stock":this.loadReport()}},printSaleReport:function(){this.$htmlToPaper("low-stock-report")},loadStockReport:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i.ih.get(t||"/api/nexopos/v4/reports/stock-report").subscribe({next:function(t){e.stockReportResult=t},error:function(e){i.kX.error(e.message).subscribe()}})},sum:function(e,t){if(void 0!==e.data){var o=e.data.map((function(e){return e.unit_quantities})).map((function(e){var o=e.map((function(e){return e[t]}));return o.length>0?o.reduce((function(e,t){return parseFloat(e)+parseFloat(t)})):0}));if(o.length>0)return o.reduce((function(e,t){return parseFloat(e)+parseFloat(t)}))}return 0},loadReport:function(){var e=this;i.ih.get("/api/nexopos/v4/reports/low-stock").subscribe({next:function(t){e.products=t},error:function(e){i.kX.error(e.message).subscribe()}})}}};const h=(0,o(1900).Z)(f,undefined,undefined,!1,null,null,null).exports},3472:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(8603),r=o(7389);const s={data:function(){return{value:[],options:[],label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.type=this.$popupParams.type||this.type},methods:{popupCloser:n.Z,__:r.__,toggle:function(e){var t=this.value.indexOf(e);-1===t?this.value.unshift(e):this.value.splice(t,1)},isSelected:function(e){return this.value.indexOf(e)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(e){void 0!==e&&(this.value=[e]),this.$popupParams.resolve(this.value),this.close()}}};const i=(0,o(1900).Z)(s,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"shadow-xl ns-box w-6/7-screen md:w-4/7-screen lg:w-3/7-screen overflow-hidden"},[o("div",{staticClass:"p-2 flex justify-between border-b items-center ns-box-header"},[o("span",{staticClass:"text-semibold text-primary"},[e._v("\n            "+e._s(e.label)+"\n        ")]),e._v(" "),o("div",[o("ns-close-button",{on:{click:function(t){return e.close()}}})],1)]),e._v(" "),o("div",{staticClass:"flex-auto overflow-y-auto"},[o("ul",{staticClass:"ns-vertical-menu"},["select"===e.type?e._l(e.options,(function(t){return o("li",{key:t.value,staticClass:"p-2 border-b border-box-edge text-primary cursor-pointer",on:{click:function(o){return e.select(t)}}},[e._v(e._s(t.label))])})):e._e(),e._v(" "),"multiselect"===e.type?e._l(e.options,(function(t){return o("li",{key:t.value,staticClass:"p-2 border-b text-primary cursor-pointer",class:e.isSelected(t)?"active":"",on:{click:function(o){return e.toggle(t)}}},[e._v(e._s(t.label))])})):e._e()],2)]),e._v(" "),"multiselect"===e.type?o("div",{staticClass:"flex justify-between"},[o("div"),e._v(" "),o("div",[o("ns-button",{attrs:{type:"info"},on:{click:function(t){return e.select()}}},[e._v(e._s(e.__("Select")))])],1)]):e._e()])}),[],!1,null,null,null).exports}}]);